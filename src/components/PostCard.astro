---
// src/components/PostCard.astro

interface Props {
  post: {
    title: string;
    slug: string;
    date: string;
    excerpt: string;
    featuredImage?: {
      url: string;
      alt: string;
    };
  };
  rootSlug?: string; // e.g., 'blog', 'case-studies', 'guides'
}

const { post, rootSlug = 'blog' } = Astro.props;

// Format Date
const formattedDate = new Date(post.date).toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'short',
  day: 'numeric',
});

// Construct URL
const postUrl = `/${rootSlug}/${post.slug}/`;
---

<article
  class='flex flex-col bg-white shadow-sm hover:shadow-md border border-gray-100 rounded-xl h-full overflow-hidden transition-shadow duration-300'>
  {/* Image Section */}
  <a
    href={postUrl}
    class='group block relative bg-gray-100 aspect-[16/9] overflow-hidden'>
    {
      post.featuredImage ? (
        <img
          src={post.featuredImage.url}
          alt={post.featuredImage.alt || post.title}
          class='w-full h-full object-cover group-hover:scale-105 transition-transform duration-500'
          loading='lazy'
        />
      ) : (
        // Fallback Pattern if no image
        <div class='flex justify-center items-center bg-gray-50 w-full h-full text-gray-300'>
          <svg
            class='w-12 h-12'
            fill='none'
            stroke='currentColor'
            viewBox='0 0 24 24'>
            <path
              stroke-linecap='round'
              stroke-linejoin='round'
              stroke-width='1'
              d='M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z'
            />
          </svg>
        </div>
      )
    }
  </a>

  {/* Content Section */}
  <div class='flex flex-col flex-grow p-6'>
    {/* Date */}
    <time
      class='mb-2 font-semibold text-gray-400 text-xs uppercase tracking-wider'>
      {formattedDate}
    </time>

    {/* Title */}
    <h3 class='mb-3 font-bold text-gray-900 text-xl line-clamp-2 leading-tight'>
      <a href={postUrl} class='hover:text-blue-600 transition-colors'>
        {post.title}
      </a>
    </h3>

    {/* Excerpt */}
    <div
      class='flex-grow mb-4 text-gray-600 text-sm line-clamp-3 prose prose-sm'
      set:html={post.excerpt}
    />

    {/* Read More Link */}
    <div class='mt-auto pt-4 border-gray-50 border-t'>
      <a
        href={postUrl}
        class='group inline-flex items-center font-semibold text-blue-600 hover:text-blue-800 text-sm transition-colors'>
        Read Article
        <svg
          class='ml-1 w-4 h-4 transition-transform group-hover:translate-x-1 transform'
          fill='none'
          stroke='currentColor'
          viewBox='0 0 24 24'>
          <path
            stroke-linecap='round'
            stroke-linejoin='round'
            stroke-width='2'
            d='M17 8l4 4m0 0l-4 4m4-4H3'></path>
        </svg>
      </a>
    </div>
  </div>
</article>
