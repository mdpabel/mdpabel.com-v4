{
  "id": 830,
  "slug": "fake-cloudflare-captcha-malware-in-wordpress-environments",
  "date": "2025-07-24T20:41:21",
  "modified": "2025-07-24T20:41:21",
  "title": "Fake Cloudflare CAPTCHA Malware in WordPress Environments",
  "content": "",
  "excerpt": "",
  "link": "https://cms.mdpabel.com/malware-log/fake-cloudflare-captcha-malware-in-wordpress-environments/",
  "yoastHead": "<link rel=\"canonical\" href=\"https://www.mdpabel.com/malware-log/fake-cloudflare-captcha-malware-in-wordpress-environments/\" />\n<!-- This site is optimized with the Yoast SEO Premium plugin v25.9 (Yoast SEO v26.8) - https://yoast.com/product/yoast-seo-premium-wordpress/ -->\n<title>Fake Cloudflare CAPTCHA Malware in WordPress Environments - MD Pabel</title>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" />\n<meta property=\"og:locale\" content=\"en_US\" />\n<meta property=\"og:type\" content=\"article\" />\n<meta property=\"og:title\" content=\"Fake Cloudflare CAPTCHA Malware in WordPress Environments\" />\n<meta property=\"og:description\" content=\"This malware injects obfuscated JavaScript into WordPress sites, masquerading as a legitimate Cloudflare CAPTCHA verification page. It redirects users to malicious domains or tricks them into performing actions that lead to further infections, such as downloading malware or enabling browser exploits. Commonly found in compromised themes and plugins, it exploits trust in Cloudflare&#8217;s branding for [&hellip;]\" />\n<meta property=\"og:url\" content=\"https://www.mdpabel.com/malware-log/fake-cloudflare-captcha-malware-in-wordpress-environments/\" />\n<meta property=\"og:site_name\" content=\"MD Pabel\" />\n<meta name=\"twitter:card\" content=\"summary_large_image\" />\n<script type=\"application/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https://schema.org\",\"@graph\":[{\"@type\":\"TechArticle\",\"@id\":\"https://www.mdpabel.com/malware-log/fake-cloudflare-captcha-malware-in-wordpress-environments/\",\"isPartOf\":{\"@id\":\"https://www.mdpabel.com/malware-log/fake-cloudflare-captcha-malware-in-wordpress-environments/\"},\"author\":{\"name\":\"MD Pabel\",\"@id\":\"https://www.mdpabel.com/#/schema/person/73e3797b5dc8d6434e9e35e1708bb0c4\"},\"headline\":\"Fake Cloudflare CAPTCHA Malware in WordPress Environments\",\"datePublished\":\"2025-07-24T20:41:21+00:00\",\"mainEntityOfPage\":{\"@id\":\"https://www.mdpabel.com/malware-log/fake-cloudflare-captcha-malware-in-wordpress-environments/\"},\"wordCount\":65,\"inLanguage\":\"en-US\"},{\"@type\":\"WebPage\",\"@id\":\"https://www.mdpabel.com/malware-log/fake-cloudflare-captcha-malware-in-wordpress-environments/\",\"url\":\"https://www.mdpabel.com/malware-log/fake-cloudflare-captcha-malware-in-wordpress-environments/\",\"name\":\"Fake Cloudflare CAPTCHA Malware in WordPress Environments - MD Pabel\",\"isPartOf\":{\"@id\":\"https://www.mdpabel.com/#website\"},\"datePublished\":\"2025-07-24T20:41:21+00:00\",\"breadcrumb\":{\"@id\":\"https://www.mdpabel.com/malware-log/fake-cloudflare-captcha-malware-in-wordpress-environments/\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https://www.mdpabel.com/malware-log/fake-cloudflare-captcha-malware-in-wordpress-environments/\"]}]},{\"@type\":\"BreadcrumbList\",\"@id\":\"https://www.mdpabel.com/malware-log/fake-cloudflare-captcha-malware-in-wordpress-environments/\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Home\",\"item\":\"https://www.mdpabel.com/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"Fake Cloudflare CAPTCHA Malware in WordPress Environments\"}]},{\"@type\":\"WebSite\",\"@id\":\"https://www.mdpabel.com/#website\",\"url\":\"https://www.mdpabel.com/\",\"name\":\"MD Pabel\",\"description\":\"Full Stack Developer, Malware Removal &amp; Security Specialist\",\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https://www.mdpabel.com/blog/?s={search_term_string}\"},\"query-input\":{\"@type\":\"PropertyValueSpecification\",\"valueRequired\":true,\"valueName\":\"search_term_string\"}}],\"inLanguage\":\"en-US\"}]}</script>\n<!-- / Yoast SEO Premium plugin. -->",
  "categories": [],
  "acf": {
    "issue_reported": "<p dir=\"auto\">WordPress sites are displaying fake <strong>Cloudflare CAPTCHA prompts</strong> (e.g., &#8220;<strong>Human Verification Required</strong>&#8221; or &#8220;Unusual Traffic Detected&#8221;) that do not originate from Cloudflare. Upon interaction (e.g., clicking &#8220;<strong>Verify</strong>&#8220;), users are redirected to phishing sites, scam pages, or domains hosting malware. This often results in browser hijacking, data theft, or secondary infections. The malware persists in site files, surviving updates if not fully removed, and can spread via fake plugins or themes embedded in legitimate ones.</p>\n",
    "malware_type": "<ul>\n<li><strong>Primary Classification</strong>: Obfuscated JavaScript Redirect Malware with Social Engineering Elements.</li>\n<li><strong>Delivery Method</strong>: Injected into WordPress files (e.g., themes like functions.php, plugins, or hidden directories like themes inside plugins).</li>\n<li><strong>Behavior</strong>:\n<ul dir=\"auto\">\n<li>Decodes base64-encoded malicious domains from query parameters.</li>\n<li>Modifies site links (e.g., home link) to redirect to fake CAPTCHA pages on attacker-controlled domains.</li>\n<li>Uses Cloudflare&#8217;s branding to build trust, prompting users to &#8220;verify&#8221; via clicks or commands, leading to redirects or malware downloads.</li>\n</ul>\n</li>\n<li><strong>Variants</strong>: Includes &#8220;ClickFix&#8221; attacks mimicking Cloudflare Turnstile, serving bogus DDoS CAPTCHA pages that coerce users into running terminal commands or enabling exploits.</li>\n<li><strong>Impact</strong>: High â€“ Affects site SEO, user trust, and can lead to full site compromise or visitor infections. Often part of broader campaigns targeting WordPress vulnerabilities like unpatched plugins.</li>\n</ul>\n",
    "location_of_infection": "<p dir=\"auto\">The provided code is a heavily obfuscated JavaScript snippet typical of this malware family. It employs multiple layers of obfuscation, including function renaming, hexadecimal offsets, and self-referential deobfuscators to evade detection. Below is a step-by-step breakdown:</p>\n<h3 dir=\"auto\">1. <strong>Obfuscation Techniques</strong></h3>\n<ul dir=\"auto\">\n<li><strong>Function Renaming and Offsets</strong>: Functions like <em><strong>_0x3166</strong> </em>act as a string table accessor, using offsets (e.g., <em><strong>_0x52513c</strong></em> &#8211; <em><strong>0x1295</strong></em>) to retrieve strings from an array (_0x59b3() returns a large array of encoded strings).</li>\n<li><strong>Self-Deobfuscators</strong>: Nested functions (e.g., <em><strong>_0x3a585a</strong></em>, <em><strong>_0x133dd3</strong></em>, <em><strong>_0x5ccb89</strong></em>, <em><strong>_0x1795c6</strong></em>) use try-catch loops and constructors to build and execute dynamic code, avoiding static analysis.</li>\n<li><strong>Base64 and Encoding Layers</strong>: The core payload involves decoding base64 strings with additional replacements (e.g., + to space via replace(/\\+/g, &#8216;\\x20&#8217;) and decodeURIComponent(escape(atob(input)))).</li>\n<li><strong>Anti-Debugging</strong>: Constructs like while(!![]) with parseInt calculations create infinite-loop-like structures that resolve to break conditions, hiding the main logic.</li>\n</ul>\n<h3 dir=\"auto\">2. <strong>Key Components</strong></h3>\n<ul dir=\"auto\">\n<li><strong>String Table (_0x59b3())</strong>: Returns an array of obfuscated strings (e.g., encoded function names like &#8216;constructor&#8217;, &#8216;return&#8217;, &#8216;prototype&#8217;). This is deobfuscated dynamically.</li>\n<li><strong>Deobfuscation Loop</strong>: The initial anonymous function shifts an array (_0x3059cd) until a computed value (_0x43daec) matches a target, building the deobfuscated code.</li>\n<li><strong>decodeFromBase64 Function</strong>:\n<ul dir=\"auto\">\n<li>Takes a base64 input (_0x31f695).</li>\n<li>Applies multiple transformations: atob for base64 decode, escape for URL encoding, decodeURIComponent for final decoding.</li>\n<li>Handles replacements like replace(/\\+/g, &#8216;\\x20&#8217;) to fix encoded spaces.</li>\n<li>Output: A decoded string (likely a malicious domain).</li>\n</ul>\n</li>\n<li><strong>getQueryParams Function</strong>:\n<ul dir=\"auto\">\n<li>Parses window.location.search for parameters.</li>\n<li>Looks for ?domain=base64_string.</li>\n<li>Decodes the &#8216;domain&#8217; param using decodeFromBase64.</li>\n</ul>\n</li>\n<li><strong>Main Payload Execution</strong>:\n<ul dir=\"auto\">\n<li>If a decoded domain exists, it targets the site&#8217;s &#8220;home link&#8221; (e.g., logo or home button via getElementById(&#8216;homeLink&#8217;)).</li>\n<li>Sets the link&#8217;s href to https://decoded_domain/?verified=true.</li>\n<li>Adds a click event listener to prevent default navigation and force a full redirect (window.location.replace).</li>\n<li>This creates the illusion of a CAPTCHA verification, redirecting to a fake Cloudflare page on the malicious domain.</li>\n</ul>\n</li>\n</ul>\n<h3 dir=\"auto\">3. <strong>Decoded Behavior</strong></h3>\n<ul dir=\"auto\">\n<li>The malware checks for a query parameter like ?domain=encoded_malicious_domain.</li>\n<li>Decodes it to something like malicious.com.</li>\n<li>On site load, hijacks navigation links to redirect to https://malicious.com/?verified=true.</li>\n<li>The fake CAPTCHA page (hosted on the malicious domain) may prompt users to &#8220;verify&#8221; by clicking, running commands (e.g., PowerShell scripts for Windows malware), or enabling browser features, leading to infections like info-stealers or ransomware.</li>\n</ul>\n<p dir=\"auto\">This matches known variants from Sucuri and TechRadar reports, where malware serves bogus Cloudflare DDoS CAPTCHAs to deliver payloads.</p>\n",
    "cleanup_steps": "<p dir=\"auto\">The malware is commonly injected into WordPress themes (e.g., functions.php), plugins, or fake directories (e.g., themes inside plugins like plugins/plugin-name/theme-fake/). Follow these steps:</p>\n<ol dir=\"auto\">\n<li><strong>Backup and Isolate</strong>: Create a full site backup (files + database) and work on a staging site to avoid live disruptions.</li>\n<li><strong>Scan for Infections</strong>:\n<ul dir=\"auto\">\n<li>Use tools like Wordfence, Sucuri SiteCheck, or Malwarebytes to scan files.</li>\n<li>Manually inspect: Check wp-content/themes/, wp-content/plugins/, and unusual subfolders (e.g., themes in plugins).</li>\n<li>Look for obfuscated JS in .php files (e.g., base64 blobs or eval() calls).</li>\n</ul>\n</li>\n<li><strong>Remove Malicious Files</strong>:\n<ul dir=\"auto\">\n<li>Delete infected themes/plugins. Replace with clean versions from official sources.</li>\n<li>Common locations: Fake plugins (e.g., wp-cache clones), themes in plugins (e.g., plugins/akismet/twenty-twenty/ with injected JS).</li>\n<li>Remove any hidden .php or .js files with obfuscated code.</li>\n</ul>\n</li>\n<li><strong>Database Cleanup</strong>: Scan wp_options and wp_posts for injected scripts (e.g., base64 in serialized data). Use plugins like WP Security Audit Log.</li>\n<li><strong>Update and Secure</strong>:\n<ul dir=\"auto\">\n<li>Update WordPress core, themes, and plugins to the latest versions.</li>\n<li>Change all passwords (WP admin, FTP, database).</li>\n<li>Enable 2FA and harden security (e.g., via .htaccess rules, disable file editing in WP).</li>\n<li>Install security plugins (e.g., Wordfence) for real-time monitoring.</li>\n</ul>\n</li>\n<li><strong>Verify and Monitor</strong>: Clear caches, test site functionality, and monitor logs for redirects. Use Cloudflare&#8217;s actual CAPTCHA if needed, but confirm it&#8217;s legitimate.</li>\n</ol>\n",
    "result": "<div>\n<p dir=\"auto\">After analysis and cleanup, the infected WordPress site was restored to a secure state. No further redirects or fake CAPTCHAs were observed. Regular scans and updates are recommended to prevent reinfection, as this malware exploits outdated components. If the site was blacklisted (e.g., by Google), submit a reconsideration request post-cleanup.</p>\n</div>\n",
    "screenshot": [
      {
        "id": 831,
        "title": "cloudflare-verification",
        "caption": "",
        "full_image_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification.png",
        "thumbnail_image_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-150x150.png?wsr",
        "large_srcset": "https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-1024x510.png 1024w, https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-300x149.png 300w, https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-768x382.png 768w, https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-1536x764.png 1536w, https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification.png 1919w",
        "medium_srcset": "https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-300x149.png 300w, https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-1024x510.png 1024w, https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-768x382.png 768w, https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-1536x764.png 1536w, https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification.png 1919w",
        "media_details": {
          "width": 1919,
          "height": 955,
          "sizes": {
            "medium": {
              "file": "cloudflare-verification-300x149.png",
              "width": 300,
              "height": 149,
              "mime-type": "image/png",
              "filesize": 5879,
              "source_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-300x149.png?wsr"
            },
            "large": {
              "file": "cloudflare-verification-1024x510.png",
              "width": 1024,
              "height": 510,
              "mime-type": "image/png",
              "filesize": 44330,
              "source_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-1024x510.png?wsr"
            },
            "thumbnail": {
              "file": "cloudflare-verification-150x150.png",
              "width": 150,
              "height": 150,
              "mime-type": "image/png",
              "filesize": 3996,
              "source_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-150x150.png?wsr"
            },
            "medium_large": {
              "file": "cloudflare-verification-768x382.png",
              "width": 768,
              "height": 382,
              "mime-type": "image/png",
              "filesize": 25535,
              "source_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-768x382.png?wsr"
            },
            "1536x1536": {
              "file": "cloudflare-verification-1536x764.png",
              "width": 1536,
              "height": 764,
              "mime-type": "image/png",
              "filesize": 89869,
              "source_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-1536x764.png?wsr"
            }
          }
        },
        "alt_text": "",
        "url": "",
        "target": ""
      },
      {
        "id": 833,
        "title": "malware-sample-screenshot",
        "caption": "",
        "full_image_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/malware-sample-screenshot.png",
        "thumbnail_image_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/malware-sample-screenshot-150x150.png?wsr",
        "large_srcset": "https://cms.mdpabel.com/wp-content/uploads/2025/07/malware-sample-screenshot-1024x741.png 1024w, https://cms.mdpabel.com/wp-content/uploads/2025/07/malware-sample-screenshot-300x217.png 300w, https://cms.mdpabel.com/wp-content/uploads/2025/07/malware-sample-screenshot-768x556.png 768w, https://cms.mdpabel.com/wp-content/uploads/2025/07/malware-sample-screenshot.png 1123w",
        "medium_srcset": "https://cms.mdpabel.com/wp-content/uploads/2025/07/malware-sample-screenshot-300x217.png 300w, https://cms.mdpabel.com/wp-content/uploads/2025/07/malware-sample-screenshot-1024x741.png 1024w, https://cms.mdpabel.com/wp-content/uploads/2025/07/malware-sample-screenshot-768x556.png 768w, https://cms.mdpabel.com/wp-content/uploads/2025/07/malware-sample-screenshot.png 1123w",
        "media_details": {
          "width": 1123,
          "height": 813,
          "sizes": {
            "medium": {
              "file": "malware-sample-screenshot-300x217.png",
              "width": 300,
              "height": 217,
              "mime-type": "image/png",
              "filesize": 20038,
              "source_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/malware-sample-screenshot-300x217.png?wsr"
            },
            "large": {
              "file": "malware-sample-screenshot-1024x741.png",
              "width": 1024,
              "height": 741,
              "mime-type": "image/png",
              "filesize": 130637,
              "source_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/malware-sample-screenshot-1024x741.png?wsr"
            },
            "thumbnail": {
              "file": "malware-sample-screenshot-150x150.png",
              "width": 150,
              "height": 150,
              "mime-type": "image/png",
              "filesize": 8605,
              "source_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/malware-sample-screenshot-150x150.png?wsr"
            },
            "medium_large": {
              "file": "malware-sample-screenshot-768x556.png",
              "width": 768,
              "height": 556,
              "mime-type": "image/png",
              "filesize": 84672,
              "source_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/malware-sample-screenshot-768x556.png?wsr"
            }
          }
        },
        "alt_text": "",
        "url": "",
        "target": ""
      },
      {
        "id": 832,
        "title": "cloudflare-verification-source",
        "caption": "",
        "full_image_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-source.png",
        "thumbnail_image_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-source-150x150.png?wsr",
        "large_srcset": "https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-source-1024x526.png 1024w, https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-source-300x154.png 300w, https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-source-768x394.png 768w, https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-source-1536x789.png 1536w, https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-source.png 1897w",
        "medium_srcset": "https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-source-300x154.png 300w, https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-source-1024x526.png 1024w, https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-source-768x394.png 768w, https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-source-1536x789.png 1536w, https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-source.png 1897w",
        "media_details": {
          "width": 1897,
          "height": 974,
          "sizes": {
            "medium": {
              "file": "cloudflare-verification-source-300x154.png",
              "width": 300,
              "height": 154,
              "mime-type": "image/png",
              "filesize": 30140,
              "source_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-source-300x154.png?wsr"
            },
            "large": {
              "file": "cloudflare-verification-source-1024x526.png",
              "width": 1024,
              "height": 526,
              "mime-type": "image/png",
              "filesize": 220020,
              "source_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-source-1024x526.png?wsr"
            },
            "thumbnail": {
              "file": "cloudflare-verification-source-150x150.png",
              "width": 150,
              "height": 150,
              "mime-type": "image/png",
              "filesize": 15739,
              "source_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-source-150x150.png?wsr"
            },
            "medium_large": {
              "file": "cloudflare-verification-source-768x394.png",
              "width": 768,
              "height": 394,
              "mime-type": "image/png",
              "filesize": 137590,
              "source_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-source-768x394.png?wsr"
            },
            "1536x1536": {
              "file": "cloudflare-verification-source-1536x789.png",
              "width": 1536,
              "height": 789,
              "mime-type": "image/png",
              "filesize": 390143,
              "source_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/cloudflare-verification-source-1536x789.png?wsr"
            }
          }
        },
        "alt_text": "",
        "url": "",
        "target": ""
      }
    ]
  }
}