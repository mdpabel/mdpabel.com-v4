{
  "id": 902,
  "slug": "unmasking-trojan-php-webshell-obfuscated-backdoor-wordpress-fakeplugin-injector-exploit-kit-cloudflaremimic-powershell-and-webshell-priv8uploader-persistence-in-website-attacks",
  "date": "2025-07-28T12:35:31",
  "modified": "2025-07-28T12:44:57",
  "title": "Unmasking Trojan.PHP.Webshell.Obfuscated, Backdoor.WordPress.FakePlugin.Injector, Exploit.Kit.CloudflareMimic.PowerShell, and Webshell.Priv8Uploader.Persistence in Website Attacks",
  "content": "",
  "excerpt": "",
  "link": "https://cms.mdpabel.com/malware-log/unmasking-trojan-php-webshell-obfuscated-backdoor-wordpress-fakeplugin-injector-exploit-kit-cloudflaremimic-powershell-and-webshell-priv8uploader-persistence-in-website-attacks/",
  "yoastHead": "<link rel=\"canonical\" href=\"https://www.mdpabel.com/malware-log/unmasking-trojan-php-webshell-obfuscated-backdoor-wordpress-fakeplugin-injector-exploit-kit-cloudflaremimic-powershell-and-webshell-priv8uploader-persistence-in-website-attacks/\" />\n<!-- This site is optimized with the Yoast SEO Premium plugin v25.9 (Yoast SEO v26.8) - https://yoast.com/product/yoast-seo-premium-wordpress/ -->\n<title>Unmasking Trojan.PHP.Webshell.Obfuscated, Backdoor.WordPress.FakePlugin.Injector, Exploit.Kit.CloudflareMimic.PowerShell, and Webshell.Priv8Uploader.Persistence in Website Attacks - MD Pabel</title>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" />\n<meta property=\"og:locale\" content=\"en_US\" />\n<meta property=\"og:type\" content=\"article\" />\n<meta property=\"og:title\" content=\"Unmasking Trojan.PHP.Webshell.Obfuscated, Backdoor.WordPress.FakePlugin.Injector, Exploit.Kit.CloudflareMimic.PowerShell, and Webshell.Priv8Uploader.Persistence in Website Attacks\" />\n<meta property=\"og:url\" content=\"https://www.mdpabel.com/malware-log/unmasking-trojan-php-webshell-obfuscated-backdoor-wordpress-fakeplugin-injector-exploit-kit-cloudflaremimic-powershell-and-webshell-priv8uploader-persistence-in-website-attacks/\" />\n<meta property=\"og:site_name\" content=\"MD Pabel\" />\n<meta property=\"article:modified_time\" content=\"2025-07-28T12:44:57+00:00\" />\n<meta name=\"twitter:card\" content=\"summary_large_image\" />\n<script type=\"application/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https://schema.org\",\"@graph\":[{\"@type\":\"TechArticle\",\"@id\":\"https://www.mdpabel.com/malware-log/unmasking-trojan-php-webshell-obfuscated-backdoor-wordpress-fakeplugin-injector-exploit-kit-cloudflaremimic-powershell-and-webshell-priv8uploader-persistence-in-website-attacks/\",\"isPartOf\":{\"@id\":\"https://www.mdpabel.com/malware-log/unmasking-trojan-php-webshell-obfuscated-backdoor-wordpress-fakeplugin-injector-exploit-kit-cloudflaremimic-powershell-and-webshell-priv8uploader-persistence-in-website-attacks/\"},\"author\":{\"name\":\"MD Pabel\",\"@id\":\"https://www.mdpabel.com/#/schema/person/73e3797b5dc8d6434e9e35e1708bb0c4\"},\"headline\":\"Unmasking Trojan.PHP.Webshell.Obfuscated, Backdoor.WordPress.FakePlugin.Injector, Exploit.Kit.CloudflareMimic.PowerShell, and Webshell.Priv8Uploader.Persistence in Website Attacks\",\"datePublished\":\"2025-07-28T12:35:31+00:00\",\"dateModified\":\"2025-07-28T12:44:57+00:00\",\"mainEntityOfPage\":{\"@id\":\"https://www.mdpabel.com/malware-log/unmasking-trojan-php-webshell-obfuscated-backdoor-wordpress-fakeplugin-injector-exploit-kit-cloudflaremimic-powershell-and-webshell-priv8uploader-persistence-in-website-attacks/\"},\"wordCount\":660,\"inLanguage\":\"en-US\",\"timeRequired\":\"PT4M\"},{\"@type\":\"WebPage\",\"@id\":\"https://www.mdpabel.com/malware-log/unmasking-trojan-php-webshell-obfuscated-backdoor-wordpress-fakeplugin-injector-exploit-kit-cloudflaremimic-powershell-and-webshell-priv8uploader-persistence-in-website-attacks/\",\"url\":\"https://www.mdpabel.com/malware-log/unmasking-trojan-php-webshell-obfuscated-backdoor-wordpress-fakeplugin-injector-exploit-kit-cloudflaremimic-powershell-and-webshell-priv8uploader-persistence-in-website-attacks/\",\"name\":\"Unmasking Trojan.PHP.Webshell.Obfuscated, Backdoor.WordPress.FakePlugin.Injector, Exploit.Kit.CloudflareMimic.PowerShell, and Webshell.Priv8Uploader.Persistence in Website Attacks - MD Pabel\",\"isPartOf\":{\"@id\":\"https://www.mdpabel.com/#website\"},\"datePublished\":\"2025-07-28T12:35:31+00:00\",\"dateModified\":\"2025-07-28T12:44:57+00:00\",\"breadcrumb\":{\"@id\":\"https://www.mdpabel.com/malware-log/unmasking-trojan-php-webshell-obfuscated-backdoor-wordpress-fakeplugin-injector-exploit-kit-cloudflaremimic-powershell-and-webshell-priv8uploader-persistence-in-website-attacks/\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https://www.mdpabel.com/malware-log/unmasking-trojan-php-webshell-obfuscated-backdoor-wordpress-fakeplugin-injector-exploit-kit-cloudflaremimic-powershell-and-webshell-priv8uploader-persistence-in-website-attacks/\"]}]},{\"@type\":\"BreadcrumbList\",\"@id\":\"https://www.mdpabel.com/malware-log/unmasking-trojan-php-webshell-obfuscated-backdoor-wordpress-fakeplugin-injector-exploit-kit-cloudflaremimic-powershell-and-webshell-priv8uploader-persistence-in-website-attacks/\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Home\",\"item\":\"https://www.mdpabel.com/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"Unmasking Trojan.PHP.Webshell.Obfuscated, Backdoor.WordPress.FakePlugin.Injector, Exploit.Kit.CloudflareMimic.PowerShell, and Webshell.Priv8Uploader.Persistence in Website Attacks\"}]},{\"@type\":\"WebSite\",\"@id\":\"https://www.mdpabel.com/#website\",\"url\":\"https://www.mdpabel.com/\",\"name\":\"MD Pabel\",\"description\":\"Full Stack Developer, Malware Removal &amp; Security Specialist\",\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https://www.mdpabel.com/blog/?s={search_term_string}\"},\"query-input\":{\"@type\":\"PropertyValueSpecification\",\"valueRequired\":true,\"valueName\":\"search_term_string\"}}],\"inLanguage\":\"en-US\"}]}</script>\n<!-- / Yoast SEO Premium plugin. -->",
  "categories": [],
  "acf": {
    "issue_reported": "<p>During routine monitoring, we detected anomalous behavior on a WordPress site, including unexpected redirects to <strong>fake security verification pages</strong>, <strong>unauthorized file upload forms</strong> in the interface, and server resource spikes. Logs revealed persistent unauthorized access attempts, with modified files in key directories like wp-content/plugins. The infection caused temporary site instability, but no confirmed data loss was observed. This triggered a forensic investigation to identify the root cause and mitigate risks.</p>\n",
    "malware_type": "<p>The malware primarily consisted of PHP <strong>webshells</strong>, flagged as <strong>trojans</strong> (e.g., <strong>trojan.webshell, trojan.php.agent</strong>) by scanners like <a href=\"https://www.virustotal.com/gui/\" target=\"_blank\" rel=\"noopener\"><strong>VirusTotal</strong></a>. These enabled remote server control, file uploads, and command execution. Obfuscated JavaScript injections in theme files facilitated client-side attacks, while a rogue plugin supported <strong>authentication bypass</strong> and <strong>Remote File Inclusion (RFI)</strong>. A fake CAPTCHA page aimed to trick users into running PowerShell scripts. This multi-vector attack combined server-side exploits with social engineering, indicative of a targeted campaign for persistence and escalation.</p>\n",
    "location_of_infection": "<p>The malicious code was primarily PHP-based, using layered obfuscation (<strong>base64, str_rot13, gzinflate</strong>) within <strong>eval()</strong> statements to evade detection. Core files like index.php and wp-config.php contained injected backdoors triggered by specific query parameters. For example, files like <strong>hehe.php</strong> or <strong>xx.php</strong> used error suppression (@ operator) and session_start() for persistence. A typical pattern:</p>\n<ul>\n<li><strong>Base64 decoding</strong> revealed compressed data.</li>\n<li><strong>str_rot13</strong> adjusted character offsets.</li>\n<li>gzinflate expanded to executable PHP, e.g., system(<strong>$_GET[&#8216;cmd&#8217;]</strong>) for command execution.</li>\n</ul>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"wp-image-917 aligncenter\" src=\"https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_6-300x156.png\" alt=\"\" width=\"544\" height=\"283\" srcset=\"https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_6-300x156.png 300w, https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_6-768x399.png 768w, https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_6.png 940w\" sizes=\"auto, (max-width: 544px) 100vw, 544px\" /></p>\n<p>&nbsp;</p>\n<p>These scripts enabled file uploads, directory traversal, and server enumeration. JavaScript <strong>injections in header.php</strong> and functions.php loaded external scripts from suspicious domains, potentially for data exfiltration.</p>\n<h2>Malware Behavior / Actions</h2>\n<p>Below is a detailed breakdown of the malwareâ€™s behavior and impact on the compromised server:</p>\n<h3>5.1 Web Shells and Remote Command Execution</h3>\n<p><strong>Purpose:</strong> Webshells provided remote server control via a web interface.</p>\n<p><strong>Files:</strong> Examples include add.php, hehe.php, radio.php, xx.php, wp-editor.php.</p>\n<p><strong>Actions:</strong></p>\n<ul>\n<li><strong>Command Execution:</strong> Used PHP functions (<strong>exec(), system(), shell_exec()</strong>) to run system commands like ls or whoami.</li>\n<li><strong>File Management:</strong> Enabled <strong>uploading, deleting, renaming, and permission changes (chmod())</strong> to escalate privileges.</li>\n<li><strong>Directory Traversal:</strong> Navigated the filesystem to<strong> access sensitive files (e.g., /etc/named.conf).</strong></li>\n<li><strong>Persistent Backdoors:</strong> Uploaded additional malicious scripts to maintain access.</li>\n</ul>\n<h3>5.2 Persistence Mechanisms</h3>\n<p><strong>File Creation:</strong> Scripts like add.php created directories (e.g., xl, lm) with base64-encoded payloads.</p>\n<p><strong>Encoded Payloads:</strong> Base64 hid malicious code, evading security scanners.</p>\n<p><strong>Re-entry:</strong> Encoded files (e.g., xl/index.php) ensured persistence post-cleanup.</p>\n<h3>5.3 Malicious File Uploaders</h3>\n<p><strong>Uploaders:</strong> Files like up.php and xx.php facilitated arbitrary file uploads.</p>\n<p><strong>Features:</strong> Enabled execution of uploaded PHP webshells or backdoors for ongoing control.</p>\n<h3>5.4 Phishing and Spam Operations</h3>\n<p><strong>Email Spamming:</strong> Files like lf.php acted as mailers for phishing campaigns.</p>\n<ul>\n<li><strong>Email Harvesting:</strong> Extracted addresses for targeted phishing.</li>\n<li><strong>Email Injection:</strong> Used local or SMTP servers to send malicious emails.</li>\n<li><strong>Bypass Filters:</strong> Checked for blacklisted IPs and used MD5 hashes to evade anti-spam systems.</li>\n</ul>\n<h3>5.5 Sensitive Information Gathering</h3>\n<p><strong>Server Enumeration:</strong> Files like hehe.php gathered PHP version, OS, and storage details.</p>\n<ul>\n<li><strong>Disabled Functions:</strong> Checked for restricted functions (e.g., <strong>mail(), curl_version()</strong>) to tailor exploits.</li>\n<li><strong>Config Files:</strong> Modified .htaccess and wp-config.php to manipulate settings or escalate privileges.</li>\n</ul>\n<h3>5.6 File and Permissions Manipulation</h3>\n<p><strong>Permissions:</strong> Changed <strong>file/directory permissions via chmod()</strong> for unrestricted access.</p>\n<p><strong>Obfuscation:</strong> Used <strong>base64</strong> and <strong>hexadecimal</strong> encoding to hide functionality from scanners.</p>\n<h3>5.7 Exploitation of Vulnerabilities</h3>\n<p><strong>PHP Exploits:</strong> Targeted outdated libraries like <strong>PHPMailer for remote code execution.</strong></p>\n<p><strong>Plugin Attacks:</strong> <strong>Modified plugins (e.g., jetpack, wordfence)</strong> to disable security or maintain access.</p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"wp-image-916 aligncenter\" src=\"https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_5-1-300x181.png\" alt=\"\" width=\"555\" height=\"335\" srcset=\"https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_5-1-300x181.png 300w, https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_5-1-1024x617.png 1024w, https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_5-1-768x463.png 768w, https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_5-1.png 1195w\" sizes=\"auto, (max-width: 555px) 100vw, 555px\" /></p>\n<h3>5.8 Additional Backdoors and Administrative Users</h3>\n<p><strong>Admin Users:</strong> Created unauthorized WordPress admin accounts for full site control, enabling settings changes or code injection.</p>\n<h3>5.9 Security Evasion and Anti-Detection</h3>\n<p><strong>Error Suppression:</strong> Used @ operator to hide errors.</p>\n<p><strong>Session Management:</strong> Maintained sessions via session_start() for persistent operations.</p>\n",
    "cleanup_steps": "",
    "result": "<p>Post-cleanup, the site was restored with no residual issues. No sensitive data was compromised, and performance stabilized. Logs showed no further unauthorized access. The incident highlighted the need for strict upload validation and regular updates, now implemented to prevent recurrence.</p>\n",
    "screenshot": [
      {
        "id": 918,
        "title": "Screenshot_3",
        "caption": "",
        "full_image_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_3.png",
        "thumbnail_image_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_3-150x150.png?wsr",
        "large_srcset": "https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_3-1024x208.png 1024w, https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_3-300x61.png 300w, https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_3-768x156.png 768w, https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_3.png 1123w",
        "medium_srcset": "https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_3-300x61.png 300w, https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_3-1024x208.png 1024w, https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_3-768x156.png 768w, https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_3.png 1123w",
        "media_details": {
          "width": 1123,
          "height": 228,
          "sizes": {
            "medium": {
              "file": "Screenshot_3-300x61.png",
              "width": 300,
              "height": 61,
              "mime-type": "image/png",
              "filesize": 3624,
              "source_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_3-300x61.png?wsr"
            },
            "large": {
              "file": "Screenshot_3-1024x208.png",
              "width": 1024,
              "height": 208,
              "mime-type": "image/png",
              "filesize": 19943,
              "source_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_3-1024x208.png?wsr"
            },
            "thumbnail": {
              "file": "Screenshot_3-150x150.png",
              "width": 150,
              "height": 150,
              "mime-type": "image/png",
              "filesize": 2356,
              "source_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_3-150x150.png?wsr"
            },
            "medium_large": {
              "file": "Screenshot_3-768x156.png",
              "width": 768,
              "height": 156,
              "mime-type": "image/png",
              "filesize": 13286,
              "source_url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/Screenshot_3-768x156.png?wsr"
            }
          }
        },
        "alt_text": "",
        "url": "",
        "target": ""
      }
    ]
  }
}