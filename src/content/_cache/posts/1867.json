{
  "id": 1867,
  "slug": "wordpress-pharma-hack-fix-how-to-stop-pharmaceutical-spam-in-google",
  "date": "2026-01-11T23:23:32",
  "modified": "2026-01-11T21:08:01",
  "title": "WordPress Pharma Hack Fix: How to Stop Pharmaceutical Spam in Google",
  "content": "<p>If you have noticed your WordPress site ranking for keywords like &#8220;Viagra,&#8221; &#8220;Cialis,&#8221; or other pharmaceutical terms—but the site looks completely normal when you visit it—you are likely the victim of a <strong>Cloaking Attack</strong>.</p>\n<p>We recently cleaned a client site infected with a specific variant of this malware that hides inside a file named <code>settings-functions.php</code>. Here is a breakdown of how this malware works, how we found it, and how to get rid of it.</p>\n<h2>The Symptoms: &#8220;Pharma&#8221; Scams and Hidden Files</h2>\n<p>Our client reported that their site was being flagged for &#8220;pharmaceutical scams,&#8221; yet they couldn&#8217;t see any spam ads on the homepage. Using our security scanners, we identified a malicious file hidden deep within the active theme folder (in this case, Hello Elementor):</p>\n<pre><code>wp-content/themes/hello-elementor/includes/settings-functions.php</code></pre>\n<p>While the file name sounds legitimate, the code inside was a sophisticated backdoor designed to hijack the website’s search engine rankings.</p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"wp-image-1868 aligncenter\" src=\"https://cms.mdpabel.com/wp-content/uploads/2026/01/simple-cache-malware-300x120.png\" alt=\"The Symptoms: &quot;Pharma&quot; Scams and Hidden Files\" width=\"708\" height=\"283\" srcset=\"https://cms.mdpabel.com/wp-content/uploads/2026/01/simple-cache-malware-300x120.png 300w, https://cms.mdpabel.com/wp-content/uploads/2026/01/simple-cache-malware-1024x411.png 1024w, https://cms.mdpabel.com/wp-content/uploads/2026/01/simple-cache-malware-768x308.png 768w, https://cms.mdpabel.com/wp-content/uploads/2026/01/simple-cache-malware-1536x616.png 1536w, https://cms.mdpabel.com/wp-content/uploads/2026/01/simple-cache-malware.png 1893w\" sizes=\"auto, (max-width: 708px) 100vw, 708px\" /></p>\n<h2>Analyzing the Malware: The &#8220;SimpleCache&#8221; Class</h2>\n<p>This malware is clever. It masquerades as a caching plugin to avoid detection by less experienced developers.</p>\n<h3>1. The Obfuscation (Class _keys)</h3>\n<p>The top of the file contains a class called <code>_keys</code>. This is a decoder. The malware uses base64 encoding and XOR encryption to hide its true intent.</p>\n<p>If you look at the code, you will see strings like <code>_keys::_dekr('_0', '_'.'1')</code>. This translates scrambled nonsense into readable commands, allowing the hackers to hide keywords like &#8220;Viagra&#8221; or malicious URLs from simple text searches.</p>\n<h3>2. The &#8220;SimpleCache&#8221; Disguise</h3>\n<p>The main payload is wrapped in a class named <code>SimpleCache</code>. It even includes fake documentation comments claiming to handle &#8220;caching functionality&#8221; to trick site owners into thinking it is a necessary file.</p>\n<h3>3. SEO Cloaking (The &#8220;Checkbot&#8221; Function)</h3>\n<p>The most dangerous part of this code is the <code>public function checkbot()</code>.</p>\n<p>This function checks the &#8220;User Agent&#8221; of the visitor. If the visitor is a real person, the site loads normally. However, if the visitor is <strong>Googlebot, Bingbot, or Yahoo</strong>, the malware:</p>\n<ul>\n<li>Intercepts the request.</li>\n<li>Fetches spam content from a remote server (using the <code>httpGet</code> function).</li>\n<li>Injects that spam into your pages.</li>\n</ul>\n<p>This is why your SEO tanks while the site looks fine to you. Google is indexing the spam the malware serves it.</p>\n<h3>4. Database Infection</h3>\n<p>Unlike simple viruses that just sit in files, this malware creates its own tables in your WordPress database to store spam links and configurations. In the code, we can see it initializing tables for <code>cache</code>, <code>settings</code>, and <code>tasks</code>.</p>\n<h2>How to Remove the &#8220;SimpleCache&#8221; Pharma Hack</h2>\n<div style=\"background-color: #fff3cd; border: 1px solid #ffeeba; padding: 15px; margin-bottom: 20px; border-radius: 4px;\"><span style=\"color: #000000;\"><strong style=\"color: #000000;\">Warning:</strong> This requires editing code and database tables. If you are not comfortable with this, please contact us for professional cleanup.</span></div>\n<h3>Step 1: Locate and Delete the File</h3>\n<p>Check your active theme folder (<code>wp-content/themes/your-theme-name/</code>). Look for suspicious files like:</p>\n<ul>\n<li><code>settings-functions.php</code></li>\n<li><code>class.cache.php</code></li>\n<li><code>db-cache.php</code></li>\n</ul>\n<p>If you open the file and see <code>class _keys</code> or <code>class SimpleCache</code> with scrambled text at the top, <strong>delete the file immediately.</strong></p>\n<h3>Step 2: Check functions.php</h3>\n<p>The malware needs to be &#8220;loaded&#8221; to work. Check your theme&#8217;s <code>functions.php</code> file. Look for a line that includes or requires the file you just deleted (e.g., <code>require_once('includes/settings-functions.php');</code>). Remove that line.</p>\n<h3>Step 3: Clean the Database</h3>\n<p>This specific malware creates extra tables in your database that often share your table prefix (e.g., <code>wp_</code>). Log into phpMyAdmin and look for suspicious tables that are <strong>not</strong> part of WordPress Core or your plugins. They might be named something like:</p>\n<ul>\n<li><code>wp_sc_cache</code></li>\n<li><code>wp_sc_settings</code></li>\n<li><code>wp_sc_tasks</code></li>\n</ul>\n<p><strong>Always backup your database before dropping tables.</strong></p>\n<h3>Step 4: Resubmit to Google</h3>\n<p>Once the files are gone and the database is clean, go to Google Search Console and request a re-indexing of your site. It may take a few weeks for the &#8220;Pharma&#8221; descriptions to disappear from search results.</p>\n<hr />\n<h3>Need Help Cleaning Your Site?</h3>\n<p>Malware like <code>SimpleCache</code> often creates backdoors in multiple locations. If you delete one file, it might regenerate itself the next day.</p>\n<p><a href=\"https://www.mdpabel.com/wordpress-malware-removal\"><strong>Hire us to completely clean your WordPress site and restore your SEO.</strong></a></p>\n",
  "excerpt": "<p>If you have noticed your WordPress site ranking for keywords like &#8220;Viagra,&#8221; &#8220;Cialis,&#8221; or other pharmaceutical terms—but the site looks completely normal when you visit it—you are likely the victim of a Cloaking Attack. We recently cleaned a client site infected with a specific variant of this malware that hides inside a file named settings-functions.php. [&hellip;]</p>\n",
  "link": "https://cms.mdpabel.com/wordpress-pharma-hack-fix-how-to-stop-pharmaceutical-spam-in-google/",
  "yoastHead": "<link rel=\"canonical\" href=\"https://www.mdpabel.com/blog/wordpress-pharma-hack-fix-how-to-stop-pharmaceutical-spam-in-google/\" />\n<!-- This site is optimized with the Yoast SEO Premium plugin v25.9 (Yoast SEO v26.8) - https://yoast.com/product/yoast-seo-premium-wordpress/ -->\n<title>WordPress Pharma Hack Fix: How to Stop Pharmaceutical Spam in Google - MD Pabel</title>\n<meta name=\"description\" content=\"Is your WordPress site showing pharmaceutical spam in Google search results? We analyze and remove the sophisticated &quot;SimpleCache&quot; malware hidden in theme files like settings-functions.php.\" />\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" />\n<meta property=\"og:locale\" content=\"en_US\" />\n<meta property=\"og:type\" content=\"article\" />\n<meta property=\"og:title\" content=\"WordPress Pharma Hack Fix: How to Stop Pharmaceutical Spam in Google\" />\n<meta property=\"og:description\" content=\"Is your WordPress site showing pharmaceutical spam in Google search results? We analyze and remove the sophisticated &quot;SimpleCache&quot; malware hidden in theme files like settings-functions.php.\" />\n<meta property=\"og:url\" content=\"https://www.mdpabel.com/blog/wordpress-pharma-hack-fix-how-to-stop-pharmaceutical-spam-in-google/\" />\n<meta property=\"og:site_name\" content=\"MD Pabel\" />\n<meta property=\"article:author\" content=\"https://www.mdpabel.com/author/mdpabel/\" />\n<meta property=\"article:published_time\" content=\"2026-01-11T17:23:32+00:00\" />\n<meta property=\"article:modified_time\" content=\"2026-01-11T21:08:01+00:00\" />\n<meta property=\"og:image\" content=\"https://cms.mdpabel.com/wp-content/uploads/2026/01/pharma-hack.jpg?wsr\" />\n\t<meta property=\"og:image:width\" content=\"1024\" />\n\t<meta property=\"og:image:height\" content=\"559\" />\n\t<meta property=\"og:image:type\" content=\"image/jpeg\" />\n<meta name=\"author\" content=\"MD Pabel\" />\n<meta name=\"twitter:card\" content=\"summary_large_image\" />\n<meta name=\"twitter:label1\" content=\"Written by\" />\n\t<meta name=\"twitter:data1\" content=\"MD Pabel\" />\n\t<meta name=\"twitter:label2\" content=\"Est. reading time\" />\n\t<meta name=\"twitter:data2\" content=\"4 minutes\" />\n<script type=\"application/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https://schema.org\",\"@graph\":[{\"@type\":\"TechArticle\",\"@id\":\"https://www.mdpabel.com/blog/wordpress-pharma-hack-fix-how-to-stop-pharmaceutical-spam-in-google/\",\"isPartOf\":{\"@id\":\"https://www.mdpabel.com/blog/wordpress-pharma-hack-fix-how-to-stop-pharmaceutical-spam-in-google/\"},\"author\":{\"name\":\"MD Pabel\",\"@id\":\"https://www.mdpabel.com/#/schema/person/73e3797b5dc8d6434e9e35e1708bb0c4\"},\"headline\":\"WordPress Pharma Hack Fix: How to Stop Pharmaceutical Spam in Google\",\"datePublished\":\"2026-01-11T17:23:32+00:00\",\"dateModified\":\"2026-01-11T21:08:01+00:00\",\"mainEntityOfPage\":{\"@id\":\"https://www.mdpabel.com/blog/wordpress-pharma-hack-fix-how-to-stop-pharmaceutical-spam-in-google/\"},\"wordCount\":628,\"commentCount\":0,\"image\":{\"@id\":\"https://www.mdpabel.com/blog/wordpress-pharma-hack-fix-how-to-stop-pharmaceutical-spam-in-google/\"},\"thumbnailUrl\":\"https://cms.mdpabel.com/wp-content/uploads/2026/01/pharma-hack.jpg?wsr\",\"articleSection\":[\"Hacked Website\",\"Malware Type\",\"Website Security\",\"WordPress Malware\"],\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"CommentAction\",\"name\":\"Comment\",\"target\":[\"https://www.mdpabel.com/blog/wordpress-pharma-hack-fix-how-to-stop-pharmaceutical-spam-in-google/\"]}]},{\"@type\":\"WebPage\",\"@id\":\"https://www.mdpabel.com/blog/wordpress-pharma-hack-fix-how-to-stop-pharmaceutical-spam-in-google/\",\"url\":\"https://www.mdpabel.com/blog/wordpress-pharma-hack-fix-how-to-stop-pharmaceutical-spam-in-google/\",\"name\":\"WordPress Pharma Hack Fix: How to Stop Pharmaceutical Spam in Google - MD Pabel\",\"isPartOf\":{\"@id\":\"https://www.mdpabel.com/#website\"},\"primaryImageOfPage\":{\"@id\":\"https://www.mdpabel.com/blog/wordpress-pharma-hack-fix-how-to-stop-pharmaceutical-spam-in-google/\"},\"image\":{\"@id\":\"https://www.mdpabel.com/blog/wordpress-pharma-hack-fix-how-to-stop-pharmaceutical-spam-in-google/\"},\"thumbnailUrl\":\"https://cms.mdpabel.com/wp-content/uploads/2026/01/pharma-hack.jpg?wsr\",\"datePublished\":\"2026-01-11T17:23:32+00:00\",\"dateModified\":\"2026-01-11T21:08:01+00:00\",\"author\":{\"@id\":\"https://www.mdpabel.com/#/schema/person/73e3797b5dc8d6434e9e35e1708bb0c4\"},\"description\":\"Is your WordPress site showing pharmaceutical spam in Google search results? We analyze and remove the sophisticated \\\"SimpleCache\\\" malware hidden in theme files like settings-functions.php.\",\"breadcrumb\":{\"@id\":\"https://www.mdpabel.com/blog/wordpress-pharma-hack-fix-how-to-stop-pharmaceutical-spam-in-google/\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https://www.mdpabel.com/blog/wordpress-pharma-hack-fix-how-to-stop-pharmaceutical-spam-in-google/\"]}]},{\"@type\":\"ImageObject\",\"inLanguage\":\"en-US\",\"@id\":\"https://www.mdpabel.com/blog/wordpress-pharma-hack-fix-how-to-stop-pharmaceutical-spam-in-google/\",\"url\":\"https://cms.mdpabel.com/wp-content/uploads/2026/01/pharma-hack.jpg?wsr\",\"contentUrl\":\"https://cms.mdpabel.com/wp-content/uploads/2026/01/pharma-hack.jpg?wsr\",\"width\":1024,\"height\":559,\"caption\":\"WordPress Pharma Hack Fix: How to Stop Pharmaceutical Spam in Google\"},{\"@type\":\"BreadcrumbList\",\"@id\":\"https://www.mdpabel.com/blog/wordpress-pharma-hack-fix-how-to-stop-pharmaceutical-spam-in-google/\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Home\",\"item\":\"https://www.mdpabel.com/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"WordPress Pharma Hack Fix: How to Stop Pharmaceutical Spam in Google\"}]},{\"@type\":\"WebSite\",\"@id\":\"https://www.mdpabel.com/#website\",\"url\":\"https://www.mdpabel.com/\",\"name\":\"MD Pabel\",\"description\":\"Full Stack Developer, Malware Removal &amp; Security Specialist\",\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https://www.mdpabel.com/blog/?s={search_term_string}\"},\"query-input\":{\"@type\":\"PropertyValueSpecification\",\"valueRequired\":true,\"valueName\":\"search_term_string\"}}],\"inLanguage\":\"en-US\"},{\"@type\":\"Person\",\"@id\":\"https://www.mdpabel.com/#/schema/person/73e3797b5dc8d6434e9e35e1708bb0c4\",\"name\":\"MD Pabel\",\"image\":{\"@type\":\"ImageObject\",\"inLanguage\":\"en-US\",\"@id\":\"https://www.mdpabel.com/#/schema/person/image/\",\"url\":\"https://secure.gravatar.com/avatar/b6b48a60efe9dc8cd04d4a7e5c9b22cafd47332f65a407ce270e8ad7f8843372?s=96&d=mm&r=g\",\"contentUrl\":\"https://secure.gravatar.com/avatar/b6b48a60efe9dc8cd04d4a7e5c9b22cafd47332f65a407ce270e8ad7f8843372?s=96&d=mm&r=g\",\"caption\":\"MD Pabel\"},\"description\":\"MD Pabel is the Founder and CEO of 3Zero Digital, a leading agency specializing in custom web development, WordPress security, and malware removal. With over 7+ Years of experience, he has completed more than3200+ projects, served over 2300+ clients, and resolved4500+ cases of malware and hacked websites.\",\"sameAs\":[\"https://www.mdpabel.com/\",\"https://www.facebook.com/in/mdpabe1\",\"https://www.linkedin.com/in/mdpabe1\"],\"url\":\"https://www.mdpabel.com/author/mdpabel/\"}]}</script>\n<!-- / Yoast SEO Premium plugin. -->",
  "featuredImage": {
    "url": "https://cms.mdpabel.com/wp-content/uploads/2026/01/pharma-hack.jpg",
    "alt": "WordPress Pharma Hack Fix: How to Stop Pharmaceutical Spam in Google"
  },
  "categories": [
    {
      "id": 25,
      "name": "Hacked Website",
      "slug": "hacked-website"
    },
    {
      "id": 64,
      "name": "Malware Type",
      "slug": "malware-type"
    },
    {
      "id": 13,
      "name": "Website Security",
      "slug": "website-security"
    },
    {
      "id": 27,
      "name": "WordPress Malware",
      "slug": "wordpress-malware"
    }
  ],
  "acf": {
    "custom_schema": ""
  }
}