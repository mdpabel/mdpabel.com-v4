{
  "id": 919,
  "slug": "wordpress-malware-removal-how-i-fixed-a-hacked-site-infected-with-trojan-php-webshell-obfuscated",
  "date": "2025-07-29T12:57:18",
  "modified": "2025-12-03T17:37:14",
  "title": "WordPress Malware Removal: How I Fixed a Hacked Site Infected with Trojan.PHP.Webshell.Obfuscated",
  "content": "<p>I&#8217;m MD Pabel, and I&#8217;ve been cleaning up hacked WordPress sites for years. With over 4500+ successfully fixed hacked websites under my belt, I&#8217;ve seen it all. Last month, I dealt with one of the nastiest malware infections I&#8217;ve encountered &#8211; a site completely compromised by multiple threats including Trojan.PHP.Webshell.Obfuscated, Backdoor.WordPress.FakePlugin.Injector, and several others. Here&#8217;s exactly how I removed the malware and got the site back online.</p>\n<h2>The Infected WordPress Site: Warning Signs I Noticed</h2>\n<p>The client called me because their WordPress site was acting strange. Pages were loading incredibly slow, visitors were getting redirected to spam sites, and somehow the site was sending out spam emails without their knowledge. These are classic signs of a hacked WordPress site that needs immediate malware removal.</p>\n<p>When I logged into their hosting account, the server logs showed unauthorized access attempts everywhere. I ran a quick malware scan using Sucuri, and it lit up with alerts &#8211; VirusTotal flagged multiple trojans and backdoors. This wasn&#8217;t some amateur hack job. The attackers had used sophisticated techniques, including fake Cloudflare security prompts that tricked users into downloading malicious PowerShell scripts.</p>\n<h2>WordPress Malware Removal: What I Found During Investigation</h2>\n<p>I connected to the server via SSH and started my malware removal process by examining the wp-content/plugins directory. That&#8217;s where I found the first major problem &#8211; a fake plugin directory containing backdoor files. The Backdoor.WordPress.FakePlugin.Injector had disguised itself as a legitimate security plugin, but it was actually giving hackers remote access to the entire site.</p>\n<p>The real challenge came when I discovered heavily obfuscated PHP files with names like &#8220;hehe.php&#8221; and &#8220;xx.php&#8221; &#8211; classic webshell signatures. These files contained layers of encoding designed to hide malicious code from standard malware scanners. Here&#8217;s what one looked like after I decoded it:</p>\n<pre><code>&lt;?php\r\n@error_reporting(0);  // Suppressing error messages\r\nsession_start();      // Maintaining persistent access\r\n$payload = base64_decode('malicious_code_here');\r\neval(gzinflate(str_rot13($payload)));  // Executing hidden commands\r\n?&gt;</code></pre>\n<p>The malware used multiple encoding techniques &#8211; base64 decoding, ROT13 character shifting, and gzip inflation &#8211; to hide command execution functions. Once decoded, I could see it was designed to run system commands directly from URL parameters, allowing hackers to browse server directories and steal sensitive files like database configurations.</p>\n<h2>How the Malware Achieved Persistence</h2>\n<p>What made this WordPress malware removal particularly challenging was how the infection maintained persistence. I found a file called &#8220;add.php&#8221; that was automatically creating new directories with random names like &#8220;xl&#8221; and &#8220;lm&#8221;. Inside each directory, it dropped base64-encoded index.php files that would survive server reboots and basic cleanup attempts.</p>\n<p>Another file, &#8220;lf.php&#8221;, was operating as a complete spam mailing system. It was harvesting email addresses from the WordPress database, sending phishing emails through SMTP, and using MD5 hashing to evade spam filters. This explained why the client&#8217;s hosting provider had flagged their account for suspicious email activity.</p>\n<h2>My WordPress Malware Removal Process</h2>\n<p>Here&#8217;s exactly how I cleaned the hacked site:</p>\n<p><strong>Step 1: Complete File Audit</strong><br />\nI identified and documented every infected file, including hidden webshells and backdoors scattered throughout the WordPress installation.</p>\n<p><strong>Step 2: Malware Removal</strong><br />\nI manually removed all malicious files, including the fake plugins and obfuscated PHP scripts. Simply deleting them wasn&#8217;t enough &#8211; I had to trace their connections to other compromised files.</p>\n<p><strong>Step 3: Core File Restoration</strong><br />\nI restored wp-config.php and .htaccess files from clean backups, ensuring no malicious code remained in critical WordPress files.</p>\n<p><strong>Step 4: Theme Cleanup</strong><br />\nThe attackers had injected JavaScript code into header.php that was loading external scripts from malicious CDNs. I cleaned all theme files and verified their integrity.</p>\n<p><strong>Step 5: Security Hardening</strong><br />\nI changed all file permissions from dangerous 777 settings to secure configurations, updated all plugins to their latest versions, and installed Wordfence for ongoing malware monitoring.</p>\n<h2>WordPress Security Lessons from This Malware Removal</h2>\n<p>This WordPress malware removal taught me several important things about modern hacking techniques:</p>\n<p><strong>Obfuscated Code is Everywhere:</strong> Hackers in 2025 are using multiple layers of encoding to hide malware from automated scanners. Manual code review is essential for proper malware removal.</p>\n<p><strong>Fake Plugins are Common:</strong> The Backdoor.WordPress.FakePlugin.Injector I found looked legitimate in the WordPress admin panel. Always verify plugin authenticity before installation.</p>\n<p><strong>Persistence Mechanisms are Sophisticated:</strong> Modern malware doesn&#8217;t just infect &#8211; it ensures survival through multiple backup files and regeneration scripts.</p>\n<p><strong>Social Engineering Integration:</strong> The fake Cloudflare prompts showed how malware creators combine technical exploits with social engineering to maximize infection rates.</p>\n<h2>Preventing Future WordPress Malware Infections</h2>\n<p>Based on my experience with this malware removal and fixing over 4500+ hacked websites, here are my recommendations:</p>\n<ul>\n<li>Run weekly malware scans using tools like Sucuri or Wordfence</li>\n<li>Never upload files with 777 permissions</li>\n<li>Regularly audit your wp-content directory for suspicious files</li>\n<li>Keep WordPress core, themes, and plugins updated</li>\n<li>Use strong .htaccess rules to prevent PHP execution in upload directories</li>\n<li>Monitor server logs for unauthorized access attempts</li>\n</ul>\n<h2>Get Professional WordPress Malware Removal Help</h2>\n<p>If your WordPress site is showing signs of infection &#8211; slow loading, unexpected redirects, spam emails, or security warnings &#8211; don&#8217;t wait. As someone who specializes in WordPress malware removal and has successfully fixed over 4500+ hacked websites, I know that every hour counts when dealing with compromised sites.</p>\n<p>The infection I described here took me about 8 hours to completely clean and secure. The client&#8217;s site came back online stronger than before, with enhanced security measures to prevent future attacks.</p>\n<p>For more detailed technical information about the specific malware variants I encountered, including Trojan.PHP.Webshell.Obfuscated and Webshell.Priv8Uploader.Persistence, check out my complete analysis: <a href=\"https://www.mdpabel.com/malware-log/unmasking-trojan-php-webshell-obfuscated-backdoor-wordpress-fakeplugin-injector-exploit-kit-cloudflaremimic-powershell-and-webshell-priv8uploader-persistence-in-website-attacks\" target=\"_blank\" rel=\"noopener\">Unmasking Trojan.PHP.Webshell.Obfuscated and Related Malware</a>.</p>\n<h2>Final Thoughts on WordPress Malware Removal</h2>\n<p>Dealing with hacked WordPress sites is never fun, but successfully removing complex malware like Trojan.PHP.Webshell.Obfuscated gives me satisfaction every time. Each cleanup teaches me something new about hacker techniques and helps me protect future clients better. Having fixed over 4500+ hacked websites, I can confidently say that no two infections are exactly alike.</p>\n<p>If you&#8217;ve dealt with similar WordPress malware infections, I&#8217;d love to hear about your experience. Feel free to <a href=\"https://www.mdpabel.com/wordpress-malware-removal\">reach out</a> &#8211; I&#8217;m always interested in discussing malware removal techniques and sharing knowledge with fellow WordPress security professionals.</p>\n<p>Remember: the best defense against WordPress malware is prevention, but when prevention fails, quick professional malware removal can save your site and reputation.</p>\n",
  "excerpt": "<p>I&#8217;m MD Pabel, and I&#8217;ve been cleaning up hacked WordPress sites for years. With over 4500+ successfully fixed hacked websites under my belt, I&#8217;ve seen it all. Last month, I dealt with one of the nastiest malware infections I&#8217;ve encountered &#8211; a site completely compromised by multiple threats including Trojan.PHP.Webshell.Obfuscated, Backdoor.WordPress.FakePlugin.Injector, and several others. Here&#8217;s [&hellip;]</p>\n",
  "link": "https://cms.mdpabel.com/wordpress-malware-removal-how-i-fixed-a-hacked-site-infected-with-trojan-php-webshell-obfuscated/",
  "yoastHead": "<link rel=\"canonical\" href=\"https://www.mdpabel.com/blog/wordpress-malware-removal-how-i-fixed-a-hacked-site-infected-with-trojan-php-webshell-obfuscated/\" />\n<!-- This site is optimized with the Yoast SEO Premium plugin v25.9 (Yoast SEO v26.8) - https://yoast.com/product/yoast-seo-premium-wordpress/ -->\n<title>WordPress Malware Removal: How I Fixed a Hacked Site Infected with Trojan.PHP.Webshell.Obfuscated - MD Pabel</title>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" />\n<meta property=\"og:locale\" content=\"en_US\" />\n<meta property=\"og:type\" content=\"article\" />\n<meta property=\"og:title\" content=\"WordPress Malware Removal: How I Fixed a Hacked Site Infected with Trojan.PHP.Webshell.Obfuscated\" />\n<meta property=\"og:description\" content=\"I&#8217;m MD Pabel, and I&#8217;ve been cleaning up hacked WordPress sites for years. With over 4500+ successfully fixed hacked websites under my belt, I&#8217;ve seen it all. Last month, I dealt with one of the nastiest malware infections I&#8217;ve encountered &#8211; a site completely compromised by multiple threats including Trojan.PHP.Webshell.Obfuscated, Backdoor.WordPress.FakePlugin.Injector, and several others. Here&#8217;s [&hellip;]\" />\n<meta property=\"og:url\" content=\"https://www.mdpabel.com/blog/wordpress-malware-removal-how-i-fixed-a-hacked-site-infected-with-trojan-php-webshell-obfuscated/\" />\n<meta property=\"og:site_name\" content=\"MD Pabel\" />\n<meta property=\"article:author\" content=\"https://www.mdpabel.com/author/mdpabel/\" />\n<meta property=\"article:published_time\" content=\"2025-07-29T12:57:18+00:00\" />\n<meta property=\"article:modified_time\" content=\"2025-12-03T17:37:14+00:00\" />\n<meta property=\"og:image\" content=\"https://cms.mdpabel.com/wp-content/uploads/2025/07/malware-removal-featured-img.png?wsr\" />\n\t<meta property=\"og:image:width\" content=\"1536\" />\n\t<meta property=\"og:image:height\" content=\"1024\" />\n\t<meta property=\"og:image:type\" content=\"image/png\" />\n<meta name=\"author\" content=\"MD Pabel\" />\n<meta name=\"twitter:card\" content=\"summary_large_image\" />\n<meta name=\"twitter:label1\" content=\"Written by\" />\n\t<meta name=\"twitter:data1\" content=\"MD Pabel\" />\n\t<meta name=\"twitter:label2\" content=\"Est. reading time\" />\n\t<meta name=\"twitter:data2\" content=\"5 minutes\" />\n<script type=\"application/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https://schema.org\",\"@graph\":[{\"@type\":\"TechArticle\",\"@id\":\"https://www.mdpabel.com/blog/wordpress-malware-removal-how-i-fixed-a-hacked-site-infected-with-trojan-php-webshell-obfuscated/\",\"isPartOf\":{\"@id\":\"https://www.mdpabel.com/blog/wordpress-malware-removal-how-i-fixed-a-hacked-site-infected-with-trojan-php-webshell-obfuscated/\"},\"author\":{\"name\":\"MD Pabel\",\"@id\":\"https://www.mdpabel.com/#/schema/person/73e3797b5dc8d6434e9e35e1708bb0c4\"},\"headline\":\"WordPress Malware Removal: How I Fixed a Hacked Site Infected with Trojan.PHP.Webshell.Obfuscated\",\"datePublished\":\"2025-07-29T12:57:18+00:00\",\"dateModified\":\"2025-12-03T17:37:14+00:00\",\"mainEntityOfPage\":{\"@id\":\"https://www.mdpabel.com/blog/wordpress-malware-removal-how-i-fixed-a-hacked-site-infected-with-trojan-php-webshell-obfuscated/\"},\"wordCount\":1047,\"commentCount\":0,\"image\":{\"@id\":\"https://www.mdpabel.com/blog/wordpress-malware-removal-how-i-fixed-a-hacked-site-infected-with-trojan-php-webshell-obfuscated/\"},\"thumbnailUrl\":\"https://cms.mdpabel.com/wp-content/uploads/2025/07/malware-removal-featured-img.png?wsr\",\"articleSection\":[\"Malware Type\",\"Website Issues\",\"Website Security\"],\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"CommentAction\",\"name\":\"Comment\",\"target\":[\"https://www.mdpabel.com/blog/wordpress-malware-removal-how-i-fixed-a-hacked-site-infected-with-trojan-php-webshell-obfuscated/\"]}]},{\"@type\":\"WebPage\",\"@id\":\"https://www.mdpabel.com/blog/wordpress-malware-removal-how-i-fixed-a-hacked-site-infected-with-trojan-php-webshell-obfuscated/\",\"url\":\"https://www.mdpabel.com/blog/wordpress-malware-removal-how-i-fixed-a-hacked-site-infected-with-trojan-php-webshell-obfuscated/\",\"name\":\"WordPress Malware Removal: How I Fixed a Hacked Site Infected with Trojan.PHP.Webshell.Obfuscated - MD Pabel\",\"isPartOf\":{\"@id\":\"https://www.mdpabel.com/#website\"},\"primaryImageOfPage\":{\"@id\":\"https://www.mdpabel.com/blog/wordpress-malware-removal-how-i-fixed-a-hacked-site-infected-with-trojan-php-webshell-obfuscated/\"},\"image\":{\"@id\":\"https://www.mdpabel.com/blog/wordpress-malware-removal-how-i-fixed-a-hacked-site-infected-with-trojan-php-webshell-obfuscated/\"},\"thumbnailUrl\":\"https://cms.mdpabel.com/wp-content/uploads/2025/07/malware-removal-featured-img.png?wsr\",\"datePublished\":\"2025-07-29T12:57:18+00:00\",\"dateModified\":\"2025-12-03T17:37:14+00:00\",\"author\":{\"@id\":\"https://www.mdpabel.com/#/schema/person/73e3797b5dc8d6434e9e35e1708bb0c4\"},\"breadcrumb\":{\"@id\":\"https://www.mdpabel.com/blog/wordpress-malware-removal-how-i-fixed-a-hacked-site-infected-with-trojan-php-webshell-obfuscated/\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https://www.mdpabel.com/blog/wordpress-malware-removal-how-i-fixed-a-hacked-site-infected-with-trojan-php-webshell-obfuscated/\"]}]},{\"@type\":\"ImageObject\",\"inLanguage\":\"en-US\",\"@id\":\"https://www.mdpabel.com/blog/wordpress-malware-removal-how-i-fixed-a-hacked-site-infected-with-trojan-php-webshell-obfuscated/\",\"url\":\"https://cms.mdpabel.com/wp-content/uploads/2025/07/malware-removal-featured-img.png?wsr\",\"contentUrl\":\"https://cms.mdpabel.com/wp-content/uploads/2025/07/malware-removal-featured-img.png?wsr\",\"width\":1536,\"height\":1024},{\"@type\":\"BreadcrumbList\",\"@id\":\"https://www.mdpabel.com/blog/wordpress-malware-removal-how-i-fixed-a-hacked-site-infected-with-trojan-php-webshell-obfuscated/\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Home\",\"item\":\"https://www.mdpabel.com/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"WordPress Malware Removal: How I Fixed a Hacked Site Infected with Trojan.PHP.Webshell.Obfuscated\"}]},{\"@type\":\"WebSite\",\"@id\":\"https://www.mdpabel.com/#website\",\"url\":\"https://www.mdpabel.com/\",\"name\":\"MD Pabel\",\"description\":\"Full Stack Developer, Malware Removal &amp; Security Specialist\",\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https://www.mdpabel.com/blog/?s={search_term_string}\"},\"query-input\":{\"@type\":\"PropertyValueSpecification\",\"valueRequired\":true,\"valueName\":\"search_term_string\"}}],\"inLanguage\":\"en-US\"},{\"@type\":\"Person\",\"@id\":\"https://www.mdpabel.com/#/schema/person/73e3797b5dc8d6434e9e35e1708bb0c4\",\"name\":\"MD Pabel\",\"image\":{\"@type\":\"ImageObject\",\"inLanguage\":\"en-US\",\"@id\":\"https://www.mdpabel.com/#/schema/person/image/\",\"url\":\"https://secure.gravatar.com/avatar/b6b48a60efe9dc8cd04d4a7e5c9b22cafd47332f65a407ce270e8ad7f8843372?s=96&d=mm&r=g\",\"contentUrl\":\"https://secure.gravatar.com/avatar/b6b48a60efe9dc8cd04d4a7e5c9b22cafd47332f65a407ce270e8ad7f8843372?s=96&d=mm&r=g\",\"caption\":\"MD Pabel\"},\"description\":\"MD Pabel is the Founder and CEO of 3Zero Digital, a leading agency specializing in custom web development, WordPress security, and malware removal. With over 7+ Years of experience, he has completed more than3200+ projects, served over 2300+ clients, and resolved4500+ cases of malware and hacked websites.\",\"sameAs\":[\"https://www.mdpabel.com/\",\"https://www.facebook.com/in/mdpabe1\",\"https://www.linkedin.com/in/mdpabe1\"],\"url\":\"https://www.mdpabel.com/author/mdpabel/\"}]}</script>\n<!-- / Yoast SEO Premium plugin. -->",
  "featuredImage": {
    "url": "https://cms.mdpabel.com/wp-content/uploads/2025/07/malware-removal-featured-img.png",
    "alt": ""
  },
  "categories": [
    {
      "id": 64,
      "name": "Malware Type",
      "slug": "malware-type"
    },
    {
      "id": 17,
      "name": "Website Issues",
      "slug": "website-issues"
    },
    {
      "id": 13,
      "name": "Website Security",
      "slug": "website-security"
    }
  ],
  "acf": {
    "custom_schema": ""
  }
}