{
  "id": 1815,
  "slug": "found-suspicious-code-in-functions-php-the-ghost-admin-hack-explained",
  "date": "2026-01-05T03:14:16",
  "modified": "2026-01-04T21:22:59",
  "title": "Found Suspicious Code in functions.php? The &#8220;Ghost Admin&#8221; Hack Explained",
  "content": "<p>Last week, a new client reached out to me in a panic. Their wordfence security plugin had flagged a critical file inside their active WordPress theme, but the warning message was confusing. They hadn&#8217;t noticed any defaced pages or pop-up ads, so they asked:</p>\n<blockquote><p>&#8220;My site looks fine, but there is weird, jumbled code in my <code>functions.php</code> file. Is this dangerous?&#8221;</p></blockquote>\n<p>We immediately investigated. The answer was <strong>yes</strong>.</p>\n<p>The code they found wasn&#8217;t just a glitch; it was a sophisticated &#8220;backdoor&#8221; designed to give hackers total control of the website without a password. In this case study, we will decode this specific malware (often called the &#8220;Ghost Admin&#8221; hack), explain how it works in plain English, and show you how to fix it.</p>\n<hr />\n<h2>The Discovery: What the Code Looks Like</h2>\n<p>If you are reading this because you found strange code in your <code>wp-content/themes/your-theme/functions.php</code> file, compare it to the screenshot below.</p>\n<p>The malware usually sits at the very top or very bottom of the file. It often looks like this:</p>\n<pre><code>add_action(strrev('tini'), function() {\r\n    $k = 'get_value_callback';\r\n    $p = 'label';\r\n    $fn = [ ... base64_decode strings ... ];\r\n    // ... more code ...\r\n});</code></pre>\n<p>To an untrained eye, this looks like random gibberish. This is intentional. Hackers use a technique called <strong>obfuscation</strong> (scrambling data) so that you—and basic security scanners—don&#8217;t realize what the code is actually doing.</p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter wp-image-1816\" src=\"https://cms.mdpabel.com/wp-content/uploads/2026/01/Screenshot_3-300x166.png\" alt=\"Ghost Admin malware\" width=\"732\" height=\"405\" srcset=\"https://cms.mdpabel.com/wp-content/uploads/2026/01/Screenshot_3-300x166.png 300w, https://cms.mdpabel.com/wp-content/uploads/2026/01/Screenshot_3-1024x566.png 1024w, https://cms.mdpabel.com/wp-content/uploads/2026/01/Screenshot_3-768x424.png 768w, https://cms.mdpabel.com/wp-content/uploads/2026/01/Screenshot_3.png 1365w\" sizes=\"auto, (max-width: 732px) 100vw, 732px\" /></p>\n<hr />\n<h2>Technical Deep Dive: Decoding the Malware</h2>\n<p><em>For developers and tech-savvy site owners, let’s break down exactly what this script does line-by-line.</em></p>\n<p>We took the code into an isolated testing environment to decode it. Here is the logic behind the attack:</p>\n<h3>1. The Disguise (strrev)</h3>\n<p>The code starts with <code>add_action(strrev('tini'), ...)</code>.<br />\n<code>strrev</code> stands for &#8220;String Reverse.&#8221; If you reverse the word &#8220;tini&#8221;, you get <strong>&#8220;init&#8221;</strong>. The hacker writes it backward to fool security searches. By hooking into <code>init</code>, this malware runs on <strong>every single page load</strong> of your website.</p>\n<h3>2. The Dictionary (Base64 Decoding)</h3>\n<p>The script creates a list of &#8220;secret&#8221; words using <code>base64_decode</code>. We translated them for you:</p>\n<ul>\n<li><code>chk</code> becomes <strong>is_user_logged_in</strong></li>\n<li><code>a</code> becomes <strong>wp_set_current_user</strong></li>\n<li><code>b</code> becomes <strong>wp_set_auth_cookie</strong></li>\n<li><code>c</code> becomes <strong>wp_redirect</strong></li>\n<li><code>d</code> becomes <strong>admin_url</strong></li>\n</ul>\n<h3>3. The &#8220;Ghost&#8221; Logic</h3>\n<p>The malware includes a safety check: <code>if (call_user_func($fn['chk'])) { return; }</code>.<br />\nThis translates to: <em>&#8220;If a real administrator is already logged in, do nothing.&#8221;</em> This is why the client never noticed anything wrong. The malware goes to sleep when you are working on the site to avoid detection.</p>\n<h3>4. The Attack (The Forced Login)</h3>\n<p>The script waits for a specific URL parameter: <code>?label=get_value_callback</code>.<br />\nWhen the hacker visits this URL, the code executes:</p>\n<pre><code>$user = get_userdata(1);</code></pre>\n<p>It grabs the profile for <strong>User ID 1</strong> (which is almost always the Super Administrator). It then forces WordPress to log the visitor in as that Admin and redirects them immediately to the dashboard.</p>\n<hr />\n<h2>Why This Is Dangerous</h2>\n<p>This is not a simple virus that sends spam emails. This is a <strong>total account takeover</strong>.</p>\n<p>Because the hacker is logging in as the Super Admin (User ID 1), they have the same power you do. They can:</p>\n<ul>\n<li><strong>Steal Data:</strong> Export your customer list and order details (if you use WooCommerce).</li>\n<li><strong>Create Hidden Users:</strong> Add other admin accounts that don&#8217;t show up in your main user list.</li>\n<li><strong>Destroy SEO:</strong> Inject hidden links to gambling or illegal sites, causing Google to blacklist your domain.</li>\n<li><strong>Lock You Out:</strong> Change your password and email address, taking the site away from you completely.</li>\n</ul>\n<hr />\n<h2>How to Fix It (The Right Way)</h2>\n<p>If you found this code, <strong>do not just press delete and hope for the best.</strong> Malware is like a weed; if you don&#8217;t get the roots, it grows back. Hackers usually hide multiple backdoors in different files.</p>\n<p>Here is the process we used to clean our client&#8217;s site:</p>\n<ol>\n<li><strong>Backup Immediately:</strong> Take a full backup of the site (files and database) before touching anything.</li>\n<li><strong>Reinstall Core Files:</strong> We replaced all standard WordPress files (<code>wp-admin</code>, <code>wp-includes</code>) with fresh copies from WordPress.org.</li>\n<li><strong>Clean the Theme:</strong> Since the malware was inside the theme, we deleted the theme entirely and re-downloaded a clean copy from the original developer. (Note: If you have custom code, you need a professional to manually sanitize the file).</li>\n<li><strong>Update WP Salts (Critical Step):</strong> The hacker logged in by forging cookies. To fix this, you must edit your <code>wp-config.php</code> file and generate new &#8220;Salt Keys.&#8221; This instantly invalidates all login sessions, forcing everyone (including the hacker) to be logged out.</li>\n<li><strong>Reset Passwords:</strong> Since the hacker had Admin access, we assumed they knew the passwords. We reset all user passwords and the database password.</li>\n<li><strong>Scan for &#8220;Ghost&#8221; Users:</strong> We checked the database for any unauthorized administrator accounts created recently and removed them.</li>\n</ol>\n<hr />\n<h2>Need Help Cleaning Your Site?</h2>\n<p>Dealing with code, databases, and backdoors can be risky. One wrong move can take your site offline.</p>\n<p>If you suspect your site is infected with the &#8220;Ghost Admin&#8221; malware, we can help. Our team specializes in WordPress malware removal and security hardening.</p>\n<p><strong><a href=\"https://www.mdpabel.com/wordpress-malware-removal\">Contact Us Today for a Site Audit</a></strong> – We will identify the breach, clean the infection, and secure your website so you can sleep soundly again.</p>\n",
  "excerpt": "<p>Last week, a new client reached out to me in a panic. Their wordfence security plugin had flagged a critical file inside their active WordPress theme, but the warning message was confusing. They hadn&#8217;t noticed any defaced pages or pop-up ads, so they asked: &#8220;My site looks fine, but there is weird, jumbled code in [&hellip;]</p>\n",
  "link": "https://cms.mdpabel.com/found-suspicious-code-in-functions-php-the-ghost-admin-hack-explained/",
  "yoastHead": "<link rel=\"canonical\" href=\"https://www.mdpabel.com/blog/found-suspicious-code-in-functions-php-the-ghost-admin-hack-explained/\" />\n<!-- This site is optimized with the Yoast SEO Premium plugin v25.9 (Yoast SEO v26.8) - https://yoast.com/product/yoast-seo-premium-wordpress/ -->\n<title>Found Suspicious Code in functions.php? The &quot;Ghost Admin&quot; Hack Explained - MD Pabel</title>\n<meta name=\"description\" content=\"A recent client discovered strange, jumbled code in their WordPress theme functions.php file. Read our case study on how we identified this &quot;Ghost Admin&quot; backdoor and secured their hacked site.\" />\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" />\n<meta property=\"og:locale\" content=\"en_US\" />\n<meta property=\"og:type\" content=\"article\" />\n<meta property=\"og:title\" content=\"Found Suspicious Code in functions.php? The &quot;Ghost Admin&quot; Hack Explained\" />\n<meta property=\"og:description\" content=\"A recent client discovered strange, jumbled code in their WordPress theme functions.php file. Read our case study on how we identified this &quot;Ghost Admin&quot; backdoor and secured their hacked site.\" />\n<meta property=\"og:url\" content=\"https://www.mdpabel.com/blog/found-suspicious-code-in-functions-php-the-ghost-admin-hack-explained/\" />\n<meta property=\"og:site_name\" content=\"MD Pabel\" />\n<meta property=\"article:author\" content=\"https://www.mdpabel.com/author/mdpabel/\" />\n<meta property=\"article:published_time\" content=\"2026-01-04T21:14:16+00:00\" />\n<meta property=\"article:modified_time\" content=\"2026-01-04T21:22:59+00:00\" />\n<meta property=\"og:image\" content=\"https://cms.mdpabel.com/wp-content/uploads/2026/01/Ghost-Admin-malware.jpg?wsr\" />\n\t<meta property=\"og:image:width\" content=\"1024\" />\n\t<meta property=\"og:image:height\" content=\"559\" />\n\t<meta property=\"og:image:type\" content=\"image/jpeg\" />\n<meta name=\"author\" content=\"MD Pabel\" />\n<meta name=\"twitter:card\" content=\"summary_large_image\" />\n<meta name=\"twitter:label1\" content=\"Written by\" />\n\t<meta name=\"twitter:data1\" content=\"MD Pabel\" />\n\t<meta name=\"twitter:label2\" content=\"Est. reading time\" />\n\t<meta name=\"twitter:data2\" content=\"4 minutes\" />\n<script type=\"application/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https://schema.org\",\"@graph\":[{\"@type\":\"TechArticle\",\"@id\":\"https://www.mdpabel.com/blog/found-suspicious-code-in-functions-php-the-ghost-admin-hack-explained/\",\"isPartOf\":{\"@id\":\"https://www.mdpabel.com/blog/found-suspicious-code-in-functions-php-the-ghost-admin-hack-explained/\"},\"author\":{\"name\":\"MD Pabel\",\"@id\":\"https://www.mdpabel.com/#/schema/person/73e3797b5dc8d6434e9e35e1708bb0c4\"},\"headline\":\"Found Suspicious Code in functions.php? The &#8220;Ghost Admin&#8221; Hack Explained\",\"datePublished\":\"2026-01-04T21:14:16+00:00\",\"dateModified\":\"2026-01-04T21:22:59+00:00\",\"mainEntityOfPage\":{\"@id\":\"https://www.mdpabel.com/blog/found-suspicious-code-in-functions-php-the-ghost-admin-hack-explained/\"},\"wordCount\":816,\"commentCount\":0,\"image\":{\"@id\":\"https://www.mdpabel.com/blog/found-suspicious-code-in-functions-php-the-ghost-admin-hack-explained/\"},\"thumbnailUrl\":\"https://cms.mdpabel.com/wp-content/uploads/2026/01/Ghost-Admin-malware.jpg?wsr\",\"articleSection\":[\"Hacked Website\",\"Malware Type\",\"Website Security\",\"WordPress Malware\"],\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"CommentAction\",\"name\":\"Comment\",\"target\":[\"https://www.mdpabel.com/blog/found-suspicious-code-in-functions-php-the-ghost-admin-hack-explained/\"]}]},{\"@type\":\"WebPage\",\"@id\":\"https://www.mdpabel.com/blog/found-suspicious-code-in-functions-php-the-ghost-admin-hack-explained/\",\"url\":\"https://www.mdpabel.com/blog/found-suspicious-code-in-functions-php-the-ghost-admin-hack-explained/\",\"name\":\"Found Suspicious Code in functions.php? The \\\"Ghost Admin\\\" Hack Explained - MD Pabel\",\"isPartOf\":{\"@id\":\"https://www.mdpabel.com/#website\"},\"primaryImageOfPage\":{\"@id\":\"https://www.mdpabel.com/blog/found-suspicious-code-in-functions-php-the-ghost-admin-hack-explained/\"},\"image\":{\"@id\":\"https://www.mdpabel.com/blog/found-suspicious-code-in-functions-php-the-ghost-admin-hack-explained/\"},\"thumbnailUrl\":\"https://cms.mdpabel.com/wp-content/uploads/2026/01/Ghost-Admin-malware.jpg?wsr\",\"datePublished\":\"2026-01-04T21:14:16+00:00\",\"dateModified\":\"2026-01-04T21:22:59+00:00\",\"author\":{\"@id\":\"https://www.mdpabel.com/#/schema/person/73e3797b5dc8d6434e9e35e1708bb0c4\"},\"description\":\"A recent client discovered strange, jumbled code in their WordPress theme functions.php file. Read our case study on how we identified this \\\"Ghost Admin\\\" backdoor and secured their hacked site.\",\"breadcrumb\":{\"@id\":\"https://www.mdpabel.com/blog/found-suspicious-code-in-functions-php-the-ghost-admin-hack-explained/\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https://www.mdpabel.com/blog/found-suspicious-code-in-functions-php-the-ghost-admin-hack-explained/\"]}]},{\"@type\":\"ImageObject\",\"inLanguage\":\"en-US\",\"@id\":\"https://www.mdpabel.com/blog/found-suspicious-code-in-functions-php-the-ghost-admin-hack-explained/\",\"url\":\"https://cms.mdpabel.com/wp-content/uploads/2026/01/Ghost-Admin-malware.jpg?wsr\",\"contentUrl\":\"https://cms.mdpabel.com/wp-content/uploads/2026/01/Ghost-Admin-malware.jpg?wsr\",\"width\":1024,\"height\":559,\"caption\":\"Found Suspicious Code in functions.php? The \\\"Ghost Admin\\\" Hack Explained\"},{\"@type\":\"BreadcrumbList\",\"@id\":\"https://www.mdpabel.com/blog/found-suspicious-code-in-functions-php-the-ghost-admin-hack-explained/\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Home\",\"item\":\"https://www.mdpabel.com/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"Found Suspicious Code in functions.php? The &#8220;Ghost Admin&#8221; Hack Explained\"}]},{\"@type\":\"WebSite\",\"@id\":\"https://www.mdpabel.com/#website\",\"url\":\"https://www.mdpabel.com/\",\"name\":\"MD Pabel\",\"description\":\"Full Stack Developer, Malware Removal &amp; Security Specialist\",\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https://www.mdpabel.com/blog/?s={search_term_string}\"},\"query-input\":{\"@type\":\"PropertyValueSpecification\",\"valueRequired\":true,\"valueName\":\"search_term_string\"}}],\"inLanguage\":\"en-US\"},{\"@type\":\"Person\",\"@id\":\"https://www.mdpabel.com/#/schema/person/73e3797b5dc8d6434e9e35e1708bb0c4\",\"name\":\"MD Pabel\",\"image\":{\"@type\":\"ImageObject\",\"inLanguage\":\"en-US\",\"@id\":\"https://www.mdpabel.com/#/schema/person/image/\",\"url\":\"https://secure.gravatar.com/avatar/b6b48a60efe9dc8cd04d4a7e5c9b22cafd47332f65a407ce270e8ad7f8843372?s=96&d=mm&r=g\",\"contentUrl\":\"https://secure.gravatar.com/avatar/b6b48a60efe9dc8cd04d4a7e5c9b22cafd47332f65a407ce270e8ad7f8843372?s=96&d=mm&r=g\",\"caption\":\"MD Pabel\"},\"description\":\"MD Pabel is the Founder and CEO of 3Zero Digital, a leading agency specializing in custom web development, WordPress security, and malware removal. With over 7+ Years of experience, he has completed more than3200+ projects, served over 2300+ clients, and resolved4500+ cases of malware and hacked websites.\",\"sameAs\":[\"https://www.mdpabel.com/\",\"https://www.facebook.com/in/mdpabe1\",\"https://www.linkedin.com/in/mdpabe1\"],\"url\":\"https://www.mdpabel.com/author/mdpabel/\"}]}</script>\n<!-- / Yoast SEO Premium plugin. -->",
  "featuredImage": {
    "url": "https://cms.mdpabel.com/wp-content/uploads/2026/01/Ghost-Admin-malware.jpg",
    "alt": "Found Suspicious Code in functions.php? The \"Ghost Admin\" Hack Explained"
  },
  "categories": [
    {
      "id": 25,
      "name": "Hacked Website",
      "slug": "hacked-website"
    },
    {
      "id": 64,
      "name": "Malware Type",
      "slug": "malware-type"
    },
    {
      "id": 13,
      "name": "Website Security",
      "slug": "website-security"
    },
    {
      "id": 27,
      "name": "WordPress Malware",
      "slug": "wordpress-malware"
    }
  ],
  "acf": {
    "custom_schema": ""
  }
}